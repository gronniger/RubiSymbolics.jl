int_rules_4_1_5 = @theory begin

    #= ::Subsection::Closed:: =#
    #= 4.1.5*trig^m*(a*cos+b*sin)^n =#
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (~a * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n) / (~b * ~d * ~n) <-- FreeQ([~a, ~b, ~c, ~d, ~n], ~x) && EqQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (-1 / ~d) * Subst(Antiderivative((((~a) ^ 2 + (~b) ^ 2) - (~x) ^ 2) ^ ((~n - 1) / 2), ~x), ~x, ~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && IGtQ((~n - 1) / 2, 0))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (-((~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x))) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1)) / (~d * ~n) + (((~n - 1) * ((~a) ^ 2 + (~b) ^ 2)) / ~n) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (Not(IntegerQ((~n - 1) / 2)) && GtQ(~n, 1)))
    @apply_utils Antiderivative(1 / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (-1 / ~d) * Subst(Antiderivative(1 / (((~a) ^ 2 + (~b) ^ 2) - (~x) ^ 2), ~x), ~x, ~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative(1 / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ 2, ~x) => sin(~c + ~d * ~x) / (~a * ~d * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x))) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1)) / (~d * (~n + 1) * ((~a) ^ 2 + (~b) ^ 2)) + ((~n + 2) / ((~n + 1) * ((~a) ^ 2 + (~b) ^ 2))) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 2), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (LtQ(~n, -1) && NeQ(~n, -2)))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((~a) ^ 2 + (~b) ^ 2) ^ (~n / 2) * Antiderivative(cos((~c + ~d * ~x) - atan(~a, ~b)) ^ ~n, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~n], ~x) && (Not(GeQ(~n, 1) || LeQ(~n, -1)) && GtQ((~a) ^ 2 + (~b) ^ 2, 0))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n / ((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) / sqrt((~a) ^ 2 + (~b) ^ 2)) ^ ~n) * Antiderivative(cos((~c + ~d * ~x) - atan(~a, ~b)) ^ ~n, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~n], ~x) && (Not(GeQ(~n, 1) || LeQ(~n, -1)) && Not(GtQ((~a) ^ 2 + (~b) ^ 2, 0) || EqQ((~a) ^ 2 + (~b) ^ 2, 0)))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (-(~a) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1)) / (~d * (~n - 1) * sin(~c + ~d * ~x) ^ (~n - 1)) + 2 * ~b * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1) / sin(~c + ~d * ~x) ^ (~n - 1), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (EqQ(~m + ~n, 0) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && GtQ(~n, 1)))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (~b * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1)) / (~d * (~n - 1) * cos(~c + ~d * ~x) ^ (~n - 1)) + 2 * ~a * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1) / cos(~c + ~d * ~x) ^ (~n - 1), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (EqQ(~m + ~n, 0) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && GtQ(~n, 1)))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (~a * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n) / (2 * ~b * ~d * ~n * sin(~c + ~d * ~x) ^ ~n) + (1 / (2 * ~b)) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1) / sin(~c + ~d * ~x) ^ (~n + 1), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (EqQ(~m + ~n, 0) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~n, 0)))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (-(~b) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n) / (2 * ~a * ~d * ~n * cos(~c + ~d * ~x) ^ ~n) + (1 / (2 * ~a)) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1) / cos(~c + ~d * ~x) ^ (~n + 1), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (EqQ(~m + ~n, 0) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~n, 0)))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((~a * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n) / (2 * ~b * ~d * ~n * sin(~c + ~d * ~x) ^ ~n)) * HypergeometricFunctions._₂F₁(1, ~n, ~n + 1, (~b + ~a * cot(~c + ~d * ~x)) / (2 * ~b)) <-- FreeQ([~a, ~b, ~c, ~d, ~n], ~x) && (EqQ(~m + ~n, 0) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && Not(IntegerQ(~n))))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((-(~b) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n) / (2 * ~a * ~d * ~n * cos(~c + ~d * ~x) ^ ~n)) * HypergeometricFunctions._₂F₁(1, ~n, ~n + 1, (~a + ~b * tan(~c + ~d * ~x)) / (2 * ~a)) <-- FreeQ([~a, ~b, ~c, ~d, ~n], ~x) && (EqQ(~m + ~n, 0) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && Not(IntegerQ(~n))))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~(n'), ~x) => Antiderivative((~b + ~a * cot(~c + ~d * ~x)) ^ ~n, ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (EqQ(~m + ~n, 0) && (IntegerQ(~n) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~(n'), ~x) => Antiderivative((~a + ~b * tan(~c + ~d * ~x)) ^ ~n, ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (EqQ(~m + ~n, 0) && (IntegerQ(~n) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (1 / ~d) * Subst(Antiderivative(((~x) ^ ~m * (~a + ~b * ~x) ^ ~n) / (1 + (~x) ^ 2) ^ ((~m + ~n + 2) / 2), ~x), ~x, tan(~c + ~d * ~x)) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (IntegerQ(~n) && (IntegerQ((~m + ~n) / 2) && (NeQ(~n, -1) && Not(GtQ(~n, 0) && GtQ(~m, 1)))))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (-1 / ~d) * Subst(Antiderivative(((~x) ^ ~m * (~b + ~a * ~x) ^ ~n) / (1 + (~x) ^ 2) ^ ((~m + ~n + 2) / 2), ~x), ~x, cot(~c + ~d * ~x)) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (IntegerQ(~n) && (IntegerQ((~m + ~n) / 2) && (NeQ(~n, -1) && Not(GtQ(~n, 0) && GtQ(~m, 1)))))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~(n'), ~x) => Antiderivative(ExpandTrig(sin(~c + ~d * ~x) ^ ~m * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (IntegerQ(~m) && IGtQ(~n, 0))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~(n'), ~x) => Antiderivative(ExpandTrig(cos(~c + ~d * ~x) ^ ~m * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (IntegerQ(~m) && IGtQ(~n, 0))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (~a) ^ ~n * (~b) ^ ~n * Antiderivative(sin(~c + ~d * ~x) ^ ~m * (~b * cos(~c + ~d * ~x) + ~a * sin(~c + ~d * ~x)) ^ -(~n), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~m], ~x) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && ILtQ(~n, 0))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => (~a) ^ ~n * (~b) ^ ~n * Antiderivative(cos(~c + ~d * ~x) ^ ~m * (~b * cos(~c + ~d * ~x) + ~a * sin(~c + ~d * ~x)) ^ -(~n), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~m], ~x) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && ILtQ(~n, 0))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n / sin(~(c') + ~(d') * ~x), ~x) => (~a * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1)) / (~d * (~n - 1)) + ~b * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1), ~x) + (~a) ^ 2 * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2) / sin(~c + ~d * ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~n, -1))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n / cos(~(c') + ~(d') * ~x), ~x) => (-(~b) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1)) / (~d * (~n - 1)) + ~a * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1), ~x) + (~b) ^ 2 * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2) / cos(~c + ~d * ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~n, -1))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => -(((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(sin(~c + ~d * ~x) ^ (~m + 2) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2), ~x) + 2 * ~b * Antiderivative(sin(~c + ~d * ~x) ^ (~m + 1) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1), ~x) + (~a) ^ 2 * Antiderivative(sin(~c + ~d * ~x) ^ ~m * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (GtQ(~n, 1) && LtQ(~m, -1)))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => -(((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ (~m + 2) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2), ~x) + 2 * ~a * Antiderivative(cos(~c + ~d * ~x) ^ (~m + 1) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 1), ~x) + (~b) ^ 2 * Antiderivative(cos(~c + ~d * ~x) ^ ~m * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n - 2), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (GtQ(~n, 1) && LtQ(~m, -1)))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (~b * ~x) / ((~a) ^ 2 + (~b) ^ 2) - (~a / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative((~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (~a * ~x) / ((~a) ^ 2 + (~b) ^ 2) + (~b / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative((~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~m / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (-(~a) * sin(~c + ~d * ~x) ^ (~m - 1)) / (~d * ((~a) ^ 2 + (~b) ^ 2) * (~m - 1)) + (~b / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(sin(~c + ~d * ~x) ^ (~m - 1), ~x) + ((~a) ^ 2 / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(sin(~c + ~d * ~x) ^ (~m - 2) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && GtQ(~m, 1))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~m / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (~b * cos(~c + ~d * ~x) ^ (~m - 1)) / (~d * ((~a) ^ 2 + (~b) ^ 2) * (~m - 1)) + (~a / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ (~m - 1), ~x) + ((~b) ^ 2 / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ (~m - 2) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && GtQ(~m, 1))
    @apply_utils Antiderivative(1 / (sin(~(c') + ~(d') * ~x) * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x))), ~x) => (1 / ~a) * Antiderivative(cot(~c + ~d * ~x), ~x) - (1 / ~a) * Antiderivative((~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative(1 / (cos(~(c') + ~(d') * ~x) * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x))), ~x) => (1 / ~b) * Antiderivative(tan(~c + ~d * ~x), ~x) + (1 / ~b) * Antiderivative((~b * cos(~c + ~d * ~x) - ~a * sin(~c + ~d * ~x)) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && NeQ((~a) ^ 2 + (~b) ^ 2, 0)
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~m / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (sin(~c + ~d * ~x) ^ (~m + 1) / (~a * ~d * (~m + 1)) - (~b / (~a) ^ 2) * Antiderivative(sin(~c + ~d * ~x) ^ (~m + 1), ~x)) + (((~a) ^ 2 + (~b) ^ 2) / (~a) ^ 2) * Antiderivative(sin(~c + ~d * ~x) ^ (~m + 2) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~m, -1))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~m / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => (-(cos(~c + ~d * ~x) ^ (~m + 1)) / (~b * ~d * (~m + 1)) - (~a / (~b) ^ 2) * Antiderivative(cos(~c + ~d * ~x) ^ (~m + 1), ~x)) + (((~a) ^ 2 + (~b) ^ 2) / (~b) ^ 2) * Antiderivative(cos(~c + ~d * ~x) ^ (~m + 2) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~m, -1))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n / sin(~(c') + ~(d') * ~x), ~x) => (-((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1)) / (~a * ~d * (~n + 1)) - (~b / (~a) ^ 2) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1), ~x)) + (1 / (~a) ^ 2) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 2) / sin(~c + ~d * ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~n, -1))
    @apply_utils Antiderivative((~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n / cos(~(c') + ~(d') * ~x), ~x) => ((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1) / (~b * ~d * (~n + 1)) - (~a / (~b) ^ 2) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1), ~x)) + (1 / (~b) ^ 2) * Antiderivative((~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 2) / cos(~c + ~d * ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && LtQ(~n, -1))
    @apply_utils Antiderivative(sin(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((((~a) ^ 2 + (~b) ^ 2) / (~a) ^ 2) * Antiderivative(sin(~c + ~d * ~x) ^ (~m + 2) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n, ~x) - ((2 * ~b) / (~a) ^ 2) * Antiderivative(sin(~c + ~d * ~x) ^ (~m + 1) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1), ~x)) + (1 / (~a) ^ 2) * Antiderivative(sin(~c + ~d * ~x) ^ ~m * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 2), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (LtQ(~n, -1) && LtQ(~m, -1)))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~m * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~n, ~x) => ((((~a) ^ 2 + (~b) ^ 2) / (~b) ^ 2) * Antiderivative(cos(~c + ~d * ~x) ^ (~m + 2) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~n, ~x) - ((2 * ~a) / (~b) ^ 2) * Antiderivative(cos(~c + ~d * ~x) ^ (~m + 1) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 1), ~x)) + (1 / (~b) ^ 2) * Antiderivative(cos(~c + ~d * ~x) ^ ~m * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~n + 2), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (LtQ(~n, -1) && LtQ(~m, -1)))
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * sin(~(c') + ~(d') * ~x) ^ ~(n') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~(p'), ~x) => Antiderivative(ExpandTrig(cos(~c + ~d * ~x) ^ ~m * sin(~c + ~d * ~x) ^ ~n * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~p, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~m, ~n], ~x) && IGtQ(~p, 0)
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * sin(~(c') + ~(d') * ~x) ^ ~(n') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~p, ~x) => (~a) ^ ~p * (~b) ^ ~p * Antiderivative(cos(~c + ~d * ~x) ^ ~m * sin(~c + ~d * ~x) ^ ~n * (~b * cos(~c + ~d * ~x) + ~a * sin(~c + ~d * ~x)) ^ -(~p), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~m, ~n], ~x) && (EqQ((~a) ^ 2 + (~b) ^ 2, 0) && ILtQ(~p, 0))
    @apply_utils Antiderivative((cos(~(c') + ~(d') * ~x) ^ ~(m') * sin(~(c') + ~(d') * ~x) ^ ~(n')) / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => ((~b / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ ~m * sin(~c + ~d * ~x) ^ (~n - 1), ~x) + (~a / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ (~m - 1) * sin(~c + ~d * ~x) ^ ~n, ~x)) - ((~a * ~b) / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative((cos(~c + ~d * ~x) ^ (~m - 1) * sin(~c + ~d * ~x) ^ (~n - 1)) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (IGtQ(~m, 0) && IGtQ(~n, 0)))
    @apply_utils Antiderivative((cos(~(c') + ~(d') * ~x) ^ ~(m') * sin(~(c') + ~(d') * ~x) ^ ~(n')) / (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)), ~x) => Antiderivative(ExpandTrig((cos(~c + ~d * ~x) ^ ~m * sin(~c + ~d * ~x) ^ ~n) / (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)), ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~m, ~n], ~x) && IntegersQ(~m, ~n)
    @apply_utils Antiderivative(cos(~(c') + ~(d') * ~x) ^ ~(m') * sin(~(c') + ~(d') * ~x) ^ ~(n') * (~(a') * cos(~(c') + ~(d') * ~x) + ~(b') * sin(~(c') + ~(d') * ~x)) ^ ~p, ~x) => ((~b / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ ~m * sin(~c + ~d * ~x) ^ (~n - 1) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~p + 1), ~x) + (~a / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ (~m - 1) * sin(~c + ~d * ~x) ^ ~n * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ (~p + 1), ~x)) - ((~a * ~b) / ((~a) ^ 2 + (~b) ^ 2)) * Antiderivative(cos(~c + ~d * ~x) ^ (~m - 1) * sin(~c + ~d * ~x) ^ (~n - 1) * (~a * cos(~c + ~d * ~x) + ~b * sin(~c + ~d * ~x)) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d], ~x) && (NeQ((~a) ^ 2 + (~b) ^ 2, 0) && (IGtQ(~m, 0) && (IGtQ(~n, 0) && ILtQ(~p, 0))))
end

int_rules_4_1_7 = @theory begin

    #= ::Subsection::Closed:: =#
    #= 4.1.7*(d*trig)^m*(a+b*(c*sin)^n)^p =#
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) * (~(A') + ~(B') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (((4 * ~A * (2 * ~a + ~b) + ~B * (4 * ~a + 3 * ~b)) * ~x) / 8 - ((4 * ~A * ~b + ~B * (4 * ~a + 3 * ~b)) * cos(~e + ~f * ~x) * sin(~e + ~f * ~x)) / (8 * ~f)) - (~b * ~B * cos(~e + ~f * ~x) * sin(~e + ~f * ~x) ^ 3) / (4 * ~f) <-- FreeQ([~a, ~b, ~e, ~f, ~A, ~B], ~x)
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p * (~(A') + ~(B') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (-(~B) * cos(~e + ~f * ~x) * sin(~e + ~f * ~x) * (~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ ~p) / (2 * ~f * (~p + 1)) + (1 / (2 * (~p + 1))) * Antiderivative((~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p - 1) * Simp(~a * ~B + 2 * ~a * ~A * (~p + 1) + (2 * ~A * ~b * (~p + 1) + ~B * (~b + 2 * ~a * ~p + 2 * ~b * ~p)) * sin(~e + ~f * ~x) ^ 2, ~x), ~x) <-- FreeQ([~a, ~b, ~e, ~f, ~A, ~B], ~x) && GtQ(~p, 0)
    @apply_utils Antiderivative((~(A') + ~(B') * sin(~(e') + ~(f') * ~x) ^ 2) / (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (~B * ~x) / ~b + ((~A * ~b - ~a * ~B) / ~b) * Antiderivative(1 / (~a + ~b * sin(~e + ~f * ~x) ^ 2), ~x) <-- FreeQ([~a, ~b, ~e, ~f, ~A, ~B], ~x)
    @apply_utils Antiderivative((~(A') + ~(B') * sin(~(e') + ~(f') * ~x) ^ 2) / sqrt(~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (~B / ~b) * Antiderivative(sqrt(~a + ~b * sin(~e + ~f * ~x) ^ 2), ~x) + ((~A * ~b - ~a * ~B) / ~b) * Antiderivative(1 / sqrt(~a + ~b * sin(~e + ~f * ~x) ^ 2), ~x) <-- FreeQ([~a, ~b, ~e, ~f, ~A, ~B], ~x)
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p * (~(A') + ~(B') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (-((~A * ~b - ~a * ~B)) * cos(~e + ~f * ~x) * sin(~e + ~f * ~x) * (~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p + 1)) / (2 * ~a * ~f * (~a + ~b) * (~p + 1)) - (1 / (2 * ~a * (~a + ~b) * (~p + 1))) * Antiderivative((~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p + 1) * Simp((~a * ~B - ~A * (2 * ~a * (~p + 1) + ~b * (2 * ~p + 3))) + 2 * (~A * ~b - ~a * ~B) * (~p + 2) * sin(~e + ~f * ~x) ^ 2, ~x), ~x) <-- FreeQ([~a, ~b, ~e, ~f, ~A, ~B], ~x) && (LtQ(~p, -1) && NeQ(~a + ~b, 0))
    @apply_utils Antiderivative((~(a') + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p * (~(A') + ~(B') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], ((ff * (~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ ~p * (sec(~e + ~f * ~x) ^ 2) ^ ~p) / (~f * (~a + (~a + ~b) * tan(~e + ~f * ~x) ^ 2) ^ ~p)) * Subst(Antiderivative(((~a + (~a + ~b) * ff ^ 2 * (~x) ^ 2) ^ ~p * (~A + (~A + ~B) * ff ^ 2 * (~x) ^ 2)) / (1 + ff ^ 2 * (~x) ^ 2) ^ (~p + 2), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~A, ~B], ~x) && Not(IntegerQ(~p))
    @apply_utils Antiderivative(~(u') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p, ~x) => (~a) ^ ~p * Antiderivative(ActivateTrig(~u * cos(~e + ~f * ~x) ^ (2 * ~p)), ~x) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (EqQ(~a + ~b, 0) && IntegerQ(~p))
    @apply_utils Antiderivative(~(u') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p, ~x) => Antiderivative(ActivateTrig(~u * (~a * cos(~e + ~f * ~x) ^ 2) ^ ~p), ~x) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && EqQ(~a + ~b, 0)
    @apply_utils Antiderivative(sqrt(~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (sqrt(~a) / ~f) * Elliptic.E(~e + ~f * ~x, -(~b) / ~a) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && GtQ(~a, 0)
    @apply_utils Antiderivative(sqrt(~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (sqrt(~a + ~b * sin(~e + ~f * ~x) ^ 2) / sqrt(1 + (~b * sin(~e + ~f * ~x) ^ 2) / ~a)) * Antiderivative(sqrt(1 + (~b * sin(~e + ~f * ~x) ^ 2) / ~a), ~x) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && Not(GtQ(~a, 0))
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ 2, ~x) => (((8 * (~a) ^ 2 + 8 * ~a * ~b + 3 * (~b) ^ 2) * ~x) / 8 - (~b * (8 * ~a + 3 * ~b) * cos(~e + ~f * ~x) * sin(~e + ~f * ~x)) / (8 * ~f)) - ((~b) ^ 2 * cos(~e + ~f * ~x) * sin(~e + ~f * ~x) ^ 3) / (4 * ~f) <-- FreeQ([~a, ~b, ~e, ~f], ~x)
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p, ~x) => (-(~b) * cos(~e + ~f * ~x) * sin(~e + ~f * ~x) * (~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p - 1)) / (2 * ~f * ~p) + (1 / (2 * ~p)) * Antiderivative((~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p - 2) * Simp(~a * (~b + 2 * ~a * ~p) + ~b * (2 * ~a + ~b) * (2 * ~p - 1) * sin(~e + ~f * ~x) ^ 2, ~x), ~x) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (NeQ(~a + ~b, 0) && GtQ(~p, 1))
    @apply_utils Antiderivative(1 / (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative(1 / (~a + (~a + ~b) * ff ^ 2 * (~x) ^ 2), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x)
    @apply_utils Antiderivative(1 / sqrt(~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (1 / (sqrt(~a) * ~f)) * Elliptic.F(~e + ~f * ~x, -(~b) / ~a) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && GtQ(~a, 0)
    @apply_utils Antiderivative(1 / sqrt(~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2), ~x) => (sqrt(1 + (~b * sin(~e + ~f * ~x) ^ 2) / ~a) / sqrt(~a + ~b * sin(~e + ~f * ~x) ^ 2)) * Antiderivative(1 / sqrt(1 + (~b * sin(~e + ~f * ~x) ^ 2) / ~a), ~x) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && Not(GtQ(~a, 0))
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p, ~x) => (-(~b) * cos(~e + ~f * ~x) * sin(~e + ~f * ~x) * (~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p + 1)) / (2 * ~a * ~f * (~p + 1) * (~a + ~b)) + (1 / (2 * ~a * (~p + 1) * (~a + ~b))) * Antiderivative((~a + ~b * sin(~e + ~f * ~x) ^ 2) ^ (~p + 1) * Simp((2 * ~a * (~p + 1) + ~b * (2 * ~p + 3)) - 2 * ~b * (~p + 2) * sin(~e + ~f * ~x) ^ 2, ~x), ~x) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (NeQ(~a + ~b, 0) && LtQ(~p, -1))
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff * sqrt(cos(~e + ~f * ~x) ^ 2)) / (~f * cos(~e + ~f * ~x))) * Subst(Antiderivative((~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p / sqrt(1 - ff ^ 2 * (~x) ^ 2), ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && Not(IntegerQ(~p))
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(cos(~e + ~f * ~x), ~x)], (-ff / ~f) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * ((~a + ~b) - ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, cos(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && IntegerQ((~m - 1) / 2)
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff ^ (~m + 1) / ~f) * Subst(Antiderivative(((~x) ^ ~m * (~a + (~a + ~b) * ff ^ 2 * (~x) ^ 2) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && IntegerQ(~p))
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff ^ (~m + 1) * sqrt(cos(~e + ~f * ~x) ^ 2)) / (~f * cos(~e + ~f * ~x))) * Subst(Antiderivative(((~x) ^ ~m * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p) / sqrt(1 - ff ^ 2 * (~x) ^ 2), ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (IntegerQ(~m / 2) && Not(IntegerQ(~p)))
    @apply_utils Antiderivative((~(d') * sin(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(cos(~e + ~f * ~x), ~x)], ((-ff * (~d) ^ (2 * IntPart((~m - 1) / 2) + 1) * (~d * sin(~e + ~f * ~x)) ^ (2 * FracPart((~m - 1) / 2))) / (~f * (sin(~e + ~f * ~x) ^ 2) ^ FracPart((~m - 1) / 2))) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * ((~a + ~b) - ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, cos(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && IntegerQ((~m - 1) / 2)
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((~a + (~a + ~b) * ff ^ 2 * (~x) ^ 2) ^ ~p / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && IntegerQ(~p))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff * sqrt(cos(~e + ~f * ~x) ^ 2)) / (~f * cos(~e + ~f * ~x))) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (IntegerQ(~m / 2) && Not(IntegerQ(~p)))
    @apply_utils Antiderivative((~(d') * cos(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff * (~d) ^ (2 * IntPart((~m - 1) / 2) + 1) * (~d * cos(~e + ~f * ~x)) ^ (2 * FracPart((~m - 1) / 2))) / (~f * (cos(~e + ~f * ~x) ^ 2) ^ FracPart((~m - 1) / 2))) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative(tan(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x) ^ 2, ~x)], (ff ^ ((~m + 1) / 2) / (2 * ~f)) * Subst(Antiderivative(((~x) ^ ((~m - 1) / 2) * (~a + ~b * ff * ~x) ^ ~p) / (1 - ff * ~x) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) ^ 2 / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && IntegerQ((~m - 1) / 2)
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative(((~d * ff * ~x) ^ ~m * (~a + (~a + ~b) * ff ^ 2 * (~x) ^ 2) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m], ~x) && IntegerQ(~p)
    @apply_utils Antiderivative(tan(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff ^ (~m + 1) * sqrt(cos(~e + ~f * ~x) ^ 2)) / (~f * cos(~e + ~f * ~x))) * Subst(Antiderivative(((~x) ^ ~m * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p) / (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (IntegerQ(~m / 2) && Not(IntegerQ(~p)))
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff * (~d * tan(~e + ~f * ~x)) ^ (~m + 1) * (cos(~e + ~f * ~x) ^ 2) ^ ((~m + 1) / 2)) / (~d * ~f * sin(~e + ~f * ~x) ^ (~m + 1))) * Subst(Antiderivative(((ff * ~x) ^ ~m * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p) / (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~(m') * (~(d') * sin(~(e') + ~(f') * ~x)) ^ ~(n') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((~d * ff * ~x) ^ ~n * (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~n, ~p], ~x) && IntegerQ((~m - 1) / 2)
    @apply_utils Antiderivative((~(c') * sin(~(e') + ~(f') * ~x)) ^ ~m * sin(~(e') + ~(f') * ~x) ^ ~(n') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(cos(~e + ~f * ~x), ~x)], (-ff / ~f) * Subst(Antiderivative((~c * ff * ~x) ^ ~m * (1 - ff ^ 2 * (~x) ^ 2) ^ ((~n - 1) / 2) * ((~a + ~b) - ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, cos(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~c, ~e, ~f, ~m, ~p], ~x) && IntegerQ((~n - 1) / 2)
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m * sin(~(e') + ~(f') * ~x) ^ ~n * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff ^ (~n + 1) / ~f) * Subst(Antiderivative(((~x) ^ ~n * (~a + (~a + ~b) * ff ^ 2 * (~x) ^ 2) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ ((~m + ~n) / 2 + ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && (IntegerQ(~n / 2) && IntegerQ(~p)))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m * (~(d') * sin(~(e') + ~(f') * ~x)) ^ ~(n') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff * sqrt(cos(~e + ~f * ~x) ^ 2)) / (~f * cos(~e + ~f * ~x))) * Subst(Antiderivative((~d * ff * ~x) ^ ~n * (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~n, ~p], ~x) && IntegerQ(~m / 2)
    @apply_utils Antiderivative((~(c') * cos(~(e') + ~(f') * ~x)) ^ ~m * (~(d') * sin(~(e') + ~(f') * ~x)) ^ ~(n') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], ((ff * (~c) ^ (2 * IntPart((~m - 1) / 2) + 1) * (~c * cos(~e + ~f * ~x)) ^ (2 * FracPart((~m - 1) / 2))) / (~f * (cos(~e + ~f * ~x) ^ 2) ^ FracPart((~m - 1) / 2))) * Subst(Antiderivative((~d * ff * ~x) ^ ~n * (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ 2 * (~x) ^ 2) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative((~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p, ~x) => (-(cot(~e + ~f * ~x)) * (~b * sin(~e + ~f * ~x) ^ 2) ^ ~p) / (2 * ~f * ~p) + ((~b * (2 * ~p - 1)) / (2 * ~p)) * Antiderivative((~b * sin(~e + ~f * ~x) ^ 2) ^ (~p - 1), ~x) <-- FreeQ([~b, ~e, ~f], ~x) && (Not(IntegerQ(~p)) && GtQ(~p, 1))
    @apply_utils Antiderivative((~(b') * sin(~(e') + ~(f') * ~x) ^ 2) ^ ~p, ~x) => (cot(~e + ~f * ~x) * (~b * sin(~e + ~f * ~x) ^ 2) ^ (~p + 1)) / (~b * ~f * (2 * ~p + 1)) + ((2 * (~p + 1)) / (~b * (2 * ~p + 1))) * Antiderivative((~b * sin(~e + ~f * ~x) ^ 2) ^ (~p + 1), ~x) <-- FreeQ([~b, ~e, ~f], ~x) && (Not(IntegerQ(~p)) && LtQ(~p, -1))
    @apply_utils Antiderivative(tan(~(e') + ~(f') * ~x) ^ ~(m') * (~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x) ^ 2, ~x)], (ff ^ ((~m + 1) / 2) / (2 * ~f)) * Subst(Antiderivative(((~x) ^ ((~m - 1) / 2) * (~b * ff ^ (~n / 2) * (~x) ^ (~n / 2)) ^ ~p) / (1 - ff * ~x) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) ^ 2 / ff)) <-- FreeQ([~b, ~e, ~f, ~p], ~x) && (IntegerQ((~m - 1) / 2) && IntegerQ(~n / 2))
    @apply_utils Antiderivative(tan(~(e') + ~(f') * ~x) ^ ~(m') * (~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], (ff ^ (~m + 1) / ~f) * Subst(Antiderivative(((~x) ^ ~m * (~b * (~c * ff * ~x) ^ ~n) ^ ~p) / (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~b, ~c, ~e, ~f, ~n, ~p], ~x) && ILtQ((~m - 1) / 2, 0)
    @apply_utils Antiderivative(~(u') * (~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~p, ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], (((~b * ff ^ ~n) ^ IntPart(~p) * (~b * sin(~e + ~f * ~x) ^ ~n) ^ FracPart(~p)) / (sin(~e + ~f * ~x) / ff) ^ (~n * FracPart(~p))) * Antiderivative(ActivateTrig(~u) * (sin(~e + ~f * ~x) / ff) ^ (~n * ~p), ~x)) <-- FreeQ([~b, ~e, ~f, ~n, ~p], ~x) && (Not(IntegerQ(~p)) && (IntegerQ(~n) && (EqQ(~u, 1) || MatchQ(~u, (~(d') * (~trig)(~e + ~f * ~x)) ^ ~(m') <-- FreeQ([d, m], ~x) && MemberQ([sin, cos, tan, cot, sec, csc], trig)))))
    @apply_utils Antiderivative(~(u') * (~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~p, ~x) => (((~b) ^ IntPart(~p) * (~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ FracPart(~p)) / (~c * sin(~e + ~f * ~x)) ^ (~n * FracPart(~p))) * Antiderivative(ActivateTrig(~u) * (~c * sin(~e + ~f * ~x)) ^ (~n * ~p), ~x) <-- FreeQ([~b, ~c, ~e, ~f, ~n, ~p], ~x) && (Not(IntegerQ(~p)) && (Not(IntegerQ(~n)) && (EqQ(~u, 1) || MatchQ(~u, (~(d') * (~trig)(~e + ~f * ~x)) ^ ~(m') <-- FreeQ([d, m], ~x) && MemberQ([sin, cos, tan, cot, sec, csc], trig)))))
    #= Antiderivative(((~a)+(~b')*sin((~e')+(~f')*(~x))^4)^(~p'),~x) :=  With([ff=FreeFactors(tan(e+f*x),x)], -ff/f*Subst(Antiderivative((a+b+2*a*ff^2*x^2+a*ff^4*x^4)^p/(1+ff^2*x^2)^(2*p+1) ,x),x,cot(e+f*x)/ff)) <-- FreeQ([a,b,e,f],x) && IntegerQ(p) =#
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((~a + 2 * ~a * ff ^ 2 * (~x) ^ 2 + (~a + ~b) * ff ^ 4 * (~x) ^ 4) ^ ~p / (1 + ff ^ 2 * (~x) ^ 2) ^ (2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && IntegerQ(~p)
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~p, ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], ((ff * (~a + ~b * sin(~e + ~f * ~x) ^ 4) ^ ~p * (sec(~e + ~f * ~x) ^ 2) ^ (2 * ~p)) / (~f * (~a + 2 * ~a * tan(~e + ~f * ~x) ^ 2 + (~a + ~b) * tan(~e + ~f * ~x) ^ 4) ^ ~p)) * Subst(Antiderivative((~a + 2 * ~a * ff ^ 2 * (~x) ^ 2 + (~a + ~b) * ff ^ 4 * (~x) ^ 4) ^ ~p / (1 + ff ^ 2 * (~x) ^ 2) ^ (2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && IntegerQ(~p - 1 / 2)
    @apply_utils Antiderivative(1 / (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n), ~x) => Module([k], Dist(2 / (~a * ~n), Sum(Antiderivative(1 / (1 - sin(~e + ~f * ~x) ^ 2 / ((-1) ^ ((4k) / ~n) * Rt(-(~a) / ~b, ~n / 2))), ~x), [k, 1, ~n / 2]), ~x)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && IntegerQ(~n / 2)
    #= Antiderivative(((~a)+(~b')*sin((~e')+(~f')*(~x))^(~n))^(~p),~x) :=  With([ff=FreeFactors(tan(e+f*x),x)], -ff/f*Subst(Antiderivative((b+a*(1+ff^2*x^2)^(n/2))^p/(1+ff^2*x^2)^(n*p/2+1),x) ,x,cot(e+f*x)/ff)) <-- FreeQ([a,b,e,f],x) && IntegerQ(n/2) &&  IGtQ(p,0) =#
    @apply_utils Antiderivative((~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~p, ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((~b * ff ^ ~n * (~x) ^ ~n + ~a * (1 + ff ^ 2 * (~x) ^ 2) ^ (~n / 2)) ^ ~p / (1 + ff ^ 2 * (~x) ^ 2) ^ ((~n * ~p) / 2 + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~n / 2) && IGtQ(~p, 0))
    @apply_utils Antiderivative((~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~p, ~x) => Antiderivative(ExpandTrig((~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~e, ~f, ~n], ~x) && (IGtQ(~p, 0) || EqQ(~p, -1) && IntegerQ(~n))
    @apply_utils Antiderivative((~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~p, ~x) => Unintegrable((~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~e, ~f, ~n, ~p], ~x)
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~(p'), ~x) => With([ff = FreeFactors(cos(~e + ~f * ~x), ~x)], (-ff / ~f) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (((~a + ~b) - 2 * ~b * ff ^ 2 * (~x) ^ 2) + ~b * ff ^ 4 * (~x) ^ 4) ^ ~p, ~x), ~x, cos(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && IntegerQ((~m - 1) / 2)
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(cos(~e + ~f * ~x), ~x)], (-ff / ~f) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * (1 - ff ^ 2 * (~x) ^ 2) ^ (~n / 2)) ^ ~p, ~x), ~x, cos(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (IntegerQ((~m - 1) / 2) && IntegerQ(~n / 2))
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff ^ (~m + 1) / ~f) * Subst(Antiderivative(((~x) ^ ~m * (~a + 2 * ~a * ff ^ 2 * (~x) ^ 2 + (~a + ~b) * ff ^ 4 * (~x) ^ 4) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + 2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && IntegerQ(~p))
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff ^ (~m + 1) / ~f) * Subst(Antiderivative(((~x) ^ ~m * (~a * (1 + ff ^ 2 * (~x) ^ 2) ^ (~n / 2) + ~b * ff ^ ~n * (~x) ^ ~n) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + (~n * ~p) / 2 + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && (IntegerQ(~n / 2) && IntegerQ(~p)))
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~p, ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], ((ff ^ (~m + 1) * (~a + ~b * sin(~e + ~f * ~x) ^ 4) ^ ~p * (sec(~e + ~f * ~x) ^ 2) ^ (2 * ~p)) / (~f * Apart(~a * (1 + tan(~e + ~f * ~x) ^ 2) ^ 2 + ~b * tan(~e + ~f * ~x) ^ 4) ^ ~p)) * Subst(Antiderivative(((~x) ^ ~m * ExpandToSum(~a * (1 + ff ^ 2 * (~x) ^ 2) ^ 2 + ~b * ff ^ 4 * (~x) ^ 4, ~x) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + 2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (IntegerQ(~m / 2) && IntegerQ(~p - 1 / 2))
    @apply_utils Antiderivative(sin(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => Antiderivative(ExpandTrig(sin(~e + ~f * ~x) ^ ~m * (~a + ~b * sin(~e + ~f * ~x) ^ ~n) ^ ~p, ~x), ~x) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegersQ(~m, ~p) && (EqQ(~n, 4) || (GtQ(~p, 0) || EqQ(~p, -1) && IntegerQ(~n))))
    @apply_utils Antiderivative((~(d') * sin(~(e') + ~(f') * ~x)) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => Antiderivative(ExpandTrig((~d * sin(~e + ~f * ~x)) ^ ~m * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n], ~x) && IGtQ(~p, 0)
    @apply_utils Antiderivative((~(d') * sin(~(e') + ~(f') * ~x)) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => Unintegrable((~d * sin(~e + ~f * ~x)) ^ ~m * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x)
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((1 - ff ^ 2 * (~x) ^ 2) ^ ((~m - 1) / 2) * (~a + ~b * (~c * ff * ~x) ^ ~n) ^ ~p, ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~c, ~e, ~f, ~n, ~p], ~x) && (IntegerQ((~m - 1) / 2) && (EqQ(~n, 4) || (GtQ(~m, 0) || (IGtQ(~p, 0) || IntegersQ(~m, ~p)))))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((~a + 2 * ~a * ff ^ 2 * (~x) ^ 2 + (~a + ~b) * ff ^ 4 * (~x) ^ 4) ^ ~p / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + 2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && IntegerQ(~p))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative((~b * ff ^ ~n * (~x) ^ ~n + ~a * (1 + ff ^ 2 * (~x) ^ 2) ^ (~n / 2)) ^ ~p / (1 + ff ^ 2 * (~x) ^ 2) ^ (~m / 2 + (~n * ~p) / 2 + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IntegerQ(~m / 2) && (IntegerQ(~n / 2) && IntegerQ(~p)))
    @apply_utils Antiderivative(cos(~(e') + ~(f') * ~x) ^ ~m / (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n), ~x) => Antiderivative(expand((1 - sin(~e + ~f * ~x) ^ 2) ^ (~m / 2) / (~a + ~b * sin(~e + ~f * ~x) ^ ~n), ~x), ~x) <-- FreeQ([~a, ~b, ~e, ~f], ~x) && (IGtQ(~m / 2, 0) && IntegerQ((~n - 1) / 2))
    #= Antiderivative(cos((~e')+(~f')*(~x))^(~m)*((~a)+(~b')*sin((~e')+(~f')*(~x))^(~n))^(~p),~x) :=   Antiderivative(ExpandTrig((1-sin(e+f*x)^2)^(m/2)*(a+b*sin(e+f*x)^n)^p,x),x) <--  FreeQ([a,b,e,f],x) && IntegerQ(m/2) && IntegerQ((n-1)/2) &&  ILtQ(p,-1) && LtQ(m,0) =#
    @apply_utils Antiderivative((~(d') * cos(~(e') + ~(f') * ~x)) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => Antiderivative(ExpandTrig((~d * cos(~e + ~f * ~x)) ^ ~m * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n], ~x) && IGtQ(~p, 0)
    @apply_utils Antiderivative((~(d') * cos(~(e') + ~(f') * ~x)) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => Unintegrable((~d * cos(~e + ~f * ~x)) ^ ~m * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x)
    @apply_utils Antiderivative(tan(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x) ^ 2, ~x)], (ff ^ ((~m + 1) / 2) / (2 * ~f)) * Subst(Antiderivative(((~x) ^ ((~m - 1) / 2) * (~a + ~b * ff ^ (~n / 2) * (~x) ^ (~n / 2)) ^ ~p) / (1 - ff * ~x) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) ^ 2 / ff)) <-- FreeQ([~a, ~b, ~e, ~f, ~p], ~x) && (IntegerQ((~m - 1) / 2) && IntegerQ(~n / 2))
    @apply_utils Antiderivative(tan(~(e') + ~(f') * ~x) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(sin(~e + ~f * ~x), ~x)], (ff ^ (~m + 1) / ~f) * Subst(Antiderivative(((~x) ^ ~m * (~a + ~b * (~c * ff * ~x) ^ ~n) ^ ~p) / (1 - ff ^ 2 * (~x) ^ 2) ^ ((~m + 1) / 2), ~x), ~x, sin(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~c, ~e, ~f, ~n, ~p], ~x) && ILtQ((~m - 1) / 2, 0)
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff / ~f) * Subst(Antiderivative(((~d * ff * ~x) ^ ~m * ExpandToSum(~a * (1 + ff ^ 2 * (~x) ^ 2) ^ 2 + ~b * ff ^ 4 * (~x) ^ 4, ~x) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m], ~x) && IntegerQ(~p)
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ 4) ^ ~p, ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], ((ff * (~a + ~b * sin(~e + ~f * ~x) ^ 4) ^ ~p * (sec(~e + ~f * ~x) ^ 2) ^ (2 * ~p)) / (~f * Apart(~a * (1 + tan(~e + ~f * ~x) ^ 2) ^ 2 + ~b * tan(~e + ~f * ~x) ^ 4) ^ ~p)) * Subst(Antiderivative(((~d * ff * ~x) ^ ~m * ExpandToSum(~a * (1 + ff ^ 2 * (~x) ^ 2) ^ 2 + ~b * ff ^ 4 * (~x) ^ 4, ~x) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ (2 * ~p + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m], ~x) && IntegerQ(~p - 1 / 2)
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~n) ^ ~(p'), ~x) => With([ff = FreeFactors(tan(~e + ~f * ~x), ~x)], (ff ^ (~m + 1) / ~f) * Subst(Antiderivative(((~d * ~x) ^ ~m * (~b * ff ^ ~n * (~x) ^ ~n + ~a * (1 + ff ^ 2 * (~x) ^ 2) ^ (~n / 2)) ^ ~p) / (1 + ff ^ 2 * (~x) ^ 2) ^ ((~n * ~p) / 2 + 1), ~x), ~x, tan(~e + ~f * ~x) / ff)) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m], ~x) && (IntegerQ(~n / 2) && IGtQ(~p, 0))
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => Antiderivative(ExpandTrig((~d * tan(~e + ~f * ~x)) ^ ~m * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x), ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n], ~x) && IGtQ(~p, 0)
    @apply_utils Antiderivative((~(d') * tan(~(e') + ~(f') * ~x)) ^ ~(m') * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~(p'), ~x) => Unintegrable((~d * tan(~e + ~f * ~x)) ^ ~m * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x)
    @apply_utils Antiderivative((~(d') * cot(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~p, ~x) => (~d * cot(~e + ~f * ~x)) ^ FracPart(~m) * (tan(~e + ~f * ~x) / ~d) ^ FracPart(~m) * Antiderivative((tan(~e + ~f * ~x) / ~d) ^ -(~m) * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative((~(d') * sec(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~p, ~x) => (~d * sec(~e + ~f * ~x)) ^ FracPart(~m) * (cos(~e + ~f * ~x) / ~d) ^ FracPart(~m) * Antiderivative((cos(~e + ~f * ~x) / ~d) ^ -(~m) * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative((~(d') * csc(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * sin(~(e') + ~(f') * ~x) ^ ~(n')) ^ ~(p'), ~x) => (~d) ^ (~n * ~p) * Antiderivative((~d * csc(~e + ~f * ~x)) ^ (~m - ~n * ~p) * (~b + ~a * csc(~e + ~f * ~x) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~d, ~e, ~f, ~m, ~n, ~p], ~x) && (Not(IntegerQ(~m)) && IntegersQ(~n, ~p))
    @apply_utils Antiderivative((~(d') * csc(~(e') + ~(f') * ~x)) ^ ~m * (~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x)) ^ ~n) ^ ~p, ~x) => (~d * csc(~e + ~f * ~x)) ^ FracPart(~m) * (sin(~e + ~f * ~x) / ~d) ^ FracPart(~m) * Antiderivative((sin(~e + ~f * ~x) / ~d) ^ -(~m) * (~a + ~b * (~c * sin(~e + ~f * ~x)) ^ ~n) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f, ~m, ~n, ~p], ~x) && Not(IntegerQ(~m))
    @apply_utils Antiderivative((~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x) + ~(d') * cos(~(e') + ~(f') * ~x)) ^ 2) ^ ~p, ~x) => Antiderivative((~a + ~b * (sqrt((~c) ^ 2 + (~d) ^ 2) * sin(atan(~c, ~d) + ~e + ~f * ~x)) ^ 2) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f], ~x) && (EqQ((~p) ^ 2, 1 / 4) && GtQ(~a, 0))
    @apply_utils Antiderivative((~a + ~(b') * (~(c') * sin(~(e') + ~(f') * ~x) + ~(d') * cos(~(e') + ~(f') * ~x)) ^ 2) ^ ~p, ~x) => ((~a + ~b * (~c * sin(~e + ~f * ~x) + ~d * cos(~e + ~f * ~x)) ^ 2) ^ ~p / (1 + (~b * (~c * sin(~e + ~f * ~x) + ~d * cos(~e + ~f * ~x)) ^ 2) / ~a) ^ ~p) * Antiderivative((1 + (~b * (~c * sin(~e + ~f * ~x) + ~d * cos(~e + ~f * ~x)) ^ 2) / ~a) ^ ~p, ~x) <-- FreeQ([~a, ~b, ~c, ~d, ~e, ~f], ~x) && (EqQ((~p) ^ 2, 1 / 4) && Not(GtQ(~a, 0)))
end

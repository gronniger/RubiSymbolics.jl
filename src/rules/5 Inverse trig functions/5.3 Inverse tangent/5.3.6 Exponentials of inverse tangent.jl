int_rules_5_3_6 = @theory begin

#= ::Subsection::Closed:: =#
#= 5.3.6 Exponentials of inverse tangent =#
Int(ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (Int(((1 - im*a*x)^((im*n + 1)/2)/((1 + im*a*x)^((im*n - 1)/2)* Sqrt(1 + a^2*x^2))), x) <-- FreeQ(a, x) && IntegerQ((im*n - 1)/2))
Int(x_^m_'*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (Int(x^m*((1 - im*a*x)^((im*n + 1)/2)/((1 + im*a*x)^((im*n - 1)/2)* Sqrt(1 + a^2*x^2))), x) <-- FreeQ([a, m], x) && IntegerQ((im*n - 1)/2))
Int(ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (Int((1 - im*a*x)^(im*n/2)/(1 + im*a*x)^(im*n/2), x) <-- FreeQ([a, n], x) && Not(IntegerQ((im*n - 1)/2)))
Int(x_^m_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (Int(x^m*(1 - im*a*x)^(im*n/2)/(1 + im*a*x)^(im*n/2), x) <-- FreeQ([a, m, n], x) && Not(IntegerQ((im*n - 1)/2)))
Int(u_'*(c_ + d_'*x_)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int(u*(1 + d*x/c)^p*(1 - im*a*x)^(im*n/2)/(1 + im*a*x)^(im*n/2), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(a^2*c^2 + d^2, 0) && (IntegerQ(p) || GtQ(c, 0)))
Int(u_'*(c_ + d_'*x_)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (Int(u*(c + d*x)^p*(1 - im*a*x)^(im*n/2)/(1 + im*a*x)^(im*n/2), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(a^2*c^2 + d^2, 0) && Not(IntegerQ(p) || GtQ(c, 0)))
Int(u_'*(c_ + d_'/x_)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (d^p*Int(u/x^p*(1 + c*x/d)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(c^2 + a^2*d^2, 0) && IntegerQ(p))
Int(u_'*(c_ + d_'/x_)^p_*ℯ^(n_*ArcTanh(a_'*x_)), x_Symbol) := ((-1)^(n/2)*c^p* Int(u*(1 + d/(c*x))^ p*(1 - 1/(im*a*x))^(im*n/2)/(1 + 1/(im*a*x))^(im*n/2), x) <-- FreeQ([a, c, d, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(p)) && IntegerQ(im*n/2) && GtQ(c, 0))
Int(u_'*(c_ + d_'/x_)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (Int(u*(c + d/x)^p*(1 - im*a*x)^(im*n/2)/(1 + im*a*x)^(im*n/2), x) <-- FreeQ([a, c, d, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(p)) && IntegerQ(im*n/2) && Not(GtQ(c, 0)))
Int(u_'*(c_ + d_'/x_)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (x^p*(c + d/x)^p/(1 + c*x/d)^p* Int(u/x^p*(1 + c*x/d)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(p)))
Int(ℯ^(n_'*ArcTan(a_'*x_))/(c_ + d_'*x_^2)^(3/2), x_Symbol) := ((n + a*x)* ℯ^(n*ArcTan(a*x))/(a*c*(n^2 + 1)*Sqrt(c + d*x^2)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && Not(IntegerQ(im*n)))
Int((c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := ((n - 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcTan(a*x))/(a*c*(n^2 + 4*(p + 1)^2)) + 2*(p + 1)*(2*p + 3)/(c*(n^2 + 4*(p + 1)^2))* Int((c + d*x^2)^(p + 1)*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && LtQ(p, -1) && Not(IntegerQ(im*n)) && NeQ(n^2 + 4*(p + 1)^2, 0) && IntegerQ(2*p))
Int(ℯ^(n_'*ArcTan(a_'*x_))/(c_ + d_'*x_^2), x_Symbol) := (ℯ^(n*ArcTan(a*x))/(a*c*n) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c))
Int((c_ + d_'*x_^2)^p_'*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int((1 + a^2*x^2)^(p - im*n/2)*(1 - im*a*x)^(im*n), x) <-- FreeQ([a, c, d, p], x) && EqQ(d, a^2*c) && IntegerQ(p) && IntegerQ((im*n + 1)/2) && Not(IntegerQ(p - im*n/2)))
Int((c_ + d_'*x_^2)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int((1 - im*a*x)^(p + im*n/2)*(1 + im*a*x)^(p - im*n/2), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(d, a^2*c) && (IntegerQ(p) || GtQ(c, 0)))
Int((c_ + d_'*x_^2)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (c^(im*n/2)*Int((c + d*x^2)^(p - im*n/2)*(1 - im*a*x)^(im*n), x) <-- FreeQ([a, c, d, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)) && IGtQ(im*n/2, 0))
Int((c_ + d_'*x_^2)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (1/c^(im*n/2)*Int((c + d*x^2)^(p + im*n/2)/(1 + im*a*x)^(im*n), x) <-- FreeQ([a, c, d, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)) && ILtQ(im*n/2, 0))
Int((c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^IntPart(p)*(c + d*x^2)^FracPart(p)/(1 + a^2*x^2)^FracPart(p)* Int((1 + a^2*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)))
Int(x_*ℯ^(n_'*ArcTan(a_'*x_))/(c_ + d_'*x_^2)^(3/2), x_Symbol) := (-(1 - a*n*x)* ℯ^(n*ArcTan(a*x))/(d*(n^2 + 1)*Sqrt(c + d*x^2)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && Not(IntegerQ(im*n)))
Int(x_*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := ((c + d*x^2)^(p + 1)* ℯ^(n*ArcTan(a*x))/(2*d*(p + 1)) - a*c*n/(2*d*(p + 1))*Int((c + d*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && LtQ(p, -1) && Not(IntegerQ(im*n)) && IntegerQ(2*p))
#= Int[x_*(c_+d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]),x_Symbol] :=  (2*(p+1)+a*n*x)*(c+d*x^2)^(p+1)*E^(n*ArcTan[a*x])/(a^2*c*(n^2+4*(p+1)^ 2)) - n*(2*p+3)/(a*c*(n^2+4*(p+1)^2))*Int[(c+d*x^2)^(p+1)*E^(n*ArcTan[a*x] ),x] /; FreeQ[{a,c,d,n},x] && EqQ[d,a^2*c] && LtQ[p,-1] &&  NeQ[n^2+4*(p+1)^2,0] && Not[IntegerQ[I*n]] =#
Int(x_^2*(c_ + d_'*x_^2)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (-(1 - a*n*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcTan(a*x))/(a*d*n*(n^2 + 1)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && EqQ(n^2 - 2*(p + 1), 0) && Not(IntegerQ(im*n)))
Int(x_^2*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (-(n - 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcTan(a*x))/(a*d*(n^2 + 4*(p + 1)^2)) + (n^2 - 2*(p + 1))/(d*(n^2 + 4*(p + 1)^2))* Int((c + d*x^2)^(p + 1)*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && LtQ(p, -1) && Not(IntegerQ(im*n)) && NeQ(n^2 + 4*(p + 1)^2, 0) && IntegerQ(2*p))
Int(x_^m_'*(c_ + d_'*x_^2)^p_'*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int(x^m*(1 + a^2*x^2)^(p - im*n/2)*(1 - im*a*x)^(im*n), x) <-- FreeQ([a, c, d, m, p], x) && EqQ(d, a^2*c) && (IntegerQ(p) || GtQ(c, 0)) && IntegerQ((im*n + 1)/2) && Not(IntegerQ(p - im*n/2)))
Int(x_^m_'*(c_ + d_'*x_^2)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int(x^m*(1 - im*a*x)^(p + im*n/2)*(1 + im*a*x)^(p - im*n/2), x) <-- FreeQ([a, c, d, m, n, p], x) && EqQ(d, a^2*c) && (IntegerQ(p) || GtQ(c, 0)))
Int(x_^m_'*(c_ + d_'*x_^2)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (c^(im*n/2)*Int(x^m*(c + d*x^2)^(p - im*n/2)*(1 - im*a*x)^(im*n), x) <-- FreeQ([a, c, d, m, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)) && IGtQ(im*n/2, 0))
Int(x_^m_'*(c_ + d_'*x_^2)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (1/c^(im*n/2)*Int(x^m*(c + d*x^2)^(p + im*n/2)/(1 + im*a*x)^(im*n), x) <-- FreeQ([a, c, d, m, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)) && ILtQ(im*n/2, 0))
Int(x_^m_'*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^IntPart(p)*(c + d*x^2)^FracPart(p)/(1 + a^2*x^2)^FracPart(p)* Int(x^m*(1 + a^2*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, m, n, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)))
Int(u_*(c_ + d_'*x_^2)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int(u*(1 - im*a*x)^(p + im*n/2)*(1 + im*a*x)^(p - im*n/2), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(d, a^2*c) && (IntegerQ(p) || GtQ(c, 0)))
Int(u_*(c_ + d_'*x_^2)^p_'*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (c^IntPart(p)*(c + d*x^2)^ FracPart(p)/((1 - im*a*x)^FracPart(p)*(1 + im*a*x)^FracPart(p))* Int(u*(1 - im*a*x)^(p + im*n/2)*(1 + im*a*x)^(p - im*n/2), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(d, a^2*c) && (IntegerQ(p) || GtQ(c, 0)) && IntegerQ(im*n/2))
Int(u_*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (c^IntPart(p)*(c + d*x^2)^FracPart(p)/(1 + a^2*x^2)^FracPart(p)* Int(u*(1 + a^2*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(p) || GtQ(c, 0)) && Not(IntegerQ(im*n/2)))
Int(u_'*(c_ + d_'/x_^2)^p_'*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (d^p*Int(u/x^(2*p)*(1 + a^2*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(c - a^2*d, 0) && IntegerQ(p))
Int(u_'*(c_ + d_'/x_^2)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (c^p*Int(u*(1 - im/(a*x))^p*(1 + im/(a*x))^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, p], x) && EqQ(c - a^2*d, 0) && Not(IntegerQ(p)) && IntegerQ(im*n/2) && GtQ(c, 0))
Int(u_'*(c_ + d_'/x_^2)^p_*ℯ^(n_*ArcTan(a_'*x_)), x_Symbol) := (x^(2*p)*(c + d/x^2)^p/((1 - im*a*x)^p*(1 + im*a*x)^p)* Int(u/x^(2*p)*(1 - im*a*x)^p*(1 + im*a*x)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c - a^2*d, 0) && Not(IntegerQ(p)) && IntegerQ(im*n/2) && Not(GtQ(c, 0)))
Int(u_'*(c_ + d_'/x_^2)^p_*ℯ^(n_'*ArcTan(a_'*x_)), x_Symbol) := (x^(2*p)*(c + d/x^2)^p/(1 + a^2*x^2)^p* Int(u/x^(2*p)*(1 + a^2*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c - a^2*d, 0) && Not(IntegerQ(p)) && Not(IntegerQ(im*n/2)))
Int(ℯ^(n_'*ArcTan(c_'*(a_ + b_'*x_))), x_Symbol) := (Int((1 - im*a*c - im*b*c*x)^(im*n/2)/(1 + im*a*c + im*b*c*x)^(im*n/2), x) <-- FreeQ([a, b, c, n], x))
Int(x_^m_*ℯ^(n_*ArcTan(c_'*(a_ + b_'*x_))), x_Symbol) := (4/(im^m*n*b^(m + 1)*c^(m + 1))* Subst( Int(x^(2/(im*n))*(1 - im*a*c - (1 + im*a*c)*x^(2/(im*n)))^ m/(1 + x^(2/(im*n)))^(m + 2), x), x, (1 - im*c*(a + b*x))^(im*n/2)/(1 + im*c*(a + b*x))^(im*n/2)) <-- FreeQ([a, b, c], x) && ILtQ(m, 0) && LtQ(-1, im*n, 1))
Int((d_' + e_'*x_)^m_'*ℯ^(n_'*ArcTan(c_'*(a_ + b_'*x_))), x_Symbol) := (Int((d + e*x)^ m*(1 - im*a*c - im*b*c*x)^(im*n/2)/(1 + im*a*c + im*b*c*x)^(im*n/2), x) <-- FreeQ([a, b, c, d, e, m, n], x))
Int(u_'*(c_ + d_'*x_ + e_'*x_^2)^p_'*ℯ^(n_'*ArcTan(a_ + b_'*x_)), x_Symbol) := ((c/(1 + a^2))^p* Int(u*(1 - im*a - im*b*x)^(p + im*n/2)*(1 + im*a + im*b*x)^(p - im*n/2), x) <-- FreeQ([a, b, c, d, e, n, p], x) && EqQ(b*d, 2*a*e) && EqQ(b^2*c - e*(1 + a^2), 0) && (IntegerQ(p) || GtQ(c/(1 + a^2), 0)))
Int(u_'*(c_ + d_'*x_ + e_'*x_^2)^p_'*ℯ^(n_'*ArcTan(a_ + b_'*x_)), x_Symbol) := ((c + d*x + e*x^2)^p/(1 + a^2 + 2*a*b*x + b^2*x^2)^p* Int(u*(1 + a^2 + 2*a*b*x + b^2*x^2)^p*ℯ^(n*ArcTan(a*x)), x) <-- FreeQ([a, b, c, d, e, n, p], x) && EqQ(b*d, 2*a*e) && EqQ(b^2*c - e*(1 + a^2), 0) && Not(IntegerQ(p) || GtQ(c/(1 + a^2), 0)))
Int(u_'*ℯ^(n_'*ArcTan(c_'/(a_' + b_'*x_))), x_Symbol) := (Int(u*ℯ^(n*ArcCot(a/c + b*x/c)), x) <-- FreeQ([a, b, c, n], x))
Int(u_'*ℯ^(n_*ArcCot(a_'*x_)), x_Symbol) := ((-1)^(im*n/2)*Int(u*ℯ^(-n*ArcTan(a*x)), x) <-- FreeQ(a, x) && IntegerQ(im*n/2))
Int(ℯ^(n_*ArcCot(a_'*x_)), x_Symbol) := (-Subst( Int((1 - im*x/a)^((im*n + 1)/2)/(x^2*(1 + im*x/a)^((im*n - 1)/2)* Sqrt(1 + x^2/a^2)), x), x, 1/x) <-- FreeQ(a, x) && IntegerQ((im*n - 1)/2))
Int(x_^m_'*ℯ^(n_*ArcCot(a_'*x_)), x_Symbol) := (-Subst( Int((1 - im*x/a)^((im*n + 1)/ 2)/(x^(m + 2)*(1 + im*x/a)^((im*n - 1)/2)*Sqrt(1 + x^2/a^2)), x), x, 1/x) <-- FreeQ(a, x) && IntegerQ((im*n - 1)/2) && IntegerQ(m))
Int(ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-Subst( Int((1 - im*x/a)^(im*n/2)/(x^2*(1 + im*x/a)^(im*n/2)), x), x, 1/x) <-- FreeQ([a, n], x) && Not(IntegerQ(im*n)))
Int(x_^m_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-Subst( Int((1 - im*x/a)^(n/2)/(x^(m + 2)*(1 + im*x/a)^(n/2)), x), x, 1/x) <-- FreeQ([a, n], x) && Not(IntegerQ(im*n)) && IntegerQ(m))
Int(x_^m_*ℯ^(n_*ArcCot(a_'*x_)), x_Symbol) := (-x^m*(1/x)^m* Subst(Int((1 - im*x/a)^((im*n + 1)/ 2)/(x^(m + 2)*(1 + im*x/a)^((im*n - 1)/2)*Sqrt(1 + x^2/a^2)), x), x, 1/x) <-- FreeQ([a, m], x) && IntegerQ((im*n - 1)/2) && Not(IntegerQ(m)))
Int(x_^m_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-Subst( Int((1 - im*x/a)^(n/2)/(x^(m + 2)*(1 + im*x/a)^(n/2)), x), x, 1/x) <-- FreeQ([a, m, n], x) && Not(IntegerQ(im*n/2)) && Not(IntegerQ(m)))
Int(u_'*(c_ + d_'*x_)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (d^p*Int(u*x^p*(1 + c/(d*x))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(a^2*c^2 + d^2, 0) && Not(IntegerQ(im*n/2)) && IntegerQ(p))
Int(u_'*(c_ + d_'*x_)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((c + d*x)^p/(x^p*(1 + c/(d*x))^p)* Int(u*x^p*(1 + c/(d*x))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(a^2*c^2 + d^2, 0) && Not(IntegerQ(im*n/2)) && Not(IntegerQ(p)))
Int((c_ + d_'/x_)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p* Subst(Int((1 + d*x/c)^ p*(1 - im*x/a)^(im*n/2)/(x^2*(1 + im*x/a)^(im*n/2)), x), x, 1/x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)))
Int(x_^m_'*(c_ + d_'/x_)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p* Subst(Int((1 + d*x/c)^ p*(1 - im*x/a)^(im*n/2)/(x^(m + 2)*(1 + im*x/a)^(im*n/2)), x), x, 1/x) <-- FreeQ([a, c, d, m, n, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)) && IntegerQ(m))
Int((c_ + d_'/x_)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((c + d/x)^p/(1 + d/(c*x))^p* Int((1 + d/(c*x))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(im*n/2)) && Not(IntegerQ(p) || GtQ(c, 0)))
Int(x_^m_*(c_ + d_'/x_)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p*x^m*(1/x)^m* Subst(Int((1 + d*x/c)^ p*(1 - im*x/a)^(im*n/2)/(x^(m + 2)*(1 + im*x/a)^(im*n/2)), x), x, 1/x) <-- FreeQ([a, c, d, m, n, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)) && Not(IntegerQ(m)))
Int(u_'*(c_ + d_'/x_)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((c + d/x)^p/(1 + d/(c*x))^p* Int(u*(1 + d/(c*x))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c^2 + a^2*d^2, 0) && Not(IntegerQ(im*n/2)) && Not(IntegerQ(p) || GtQ(c, 0)))
Int(ℯ^(n_'*ArcCot(a_'*x_))/(c_ + d_'*x_^2), x_Symbol) := (-ℯ^(n*ArcCot(a*x))/(a*c*n) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c))
Int(ℯ^(n_'*ArcCot(a_'*x_))/(c_ + d_'*x_^2)^(3/2), x_Symbol) := (-(n - a*x)* ℯ^(n*ArcCot(a*x))/(a*c*(n^2 + 1)*Sqrt(c + d*x^2)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && Not(IntegerQ((im*n - 1)/2)))
Int((c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-(n + 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcCot(a*x))/(a*c*(n^2 + 4*(p + 1)^2)) + 2*(p + 1)*(2*p + 3)/(c*(n^2 + 4*(p + 1)^2))* Int((c + d*x^2)^(p + 1)*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && LtQ(p, -1) && NeQ(p, -3/2) && NeQ(n^2 + 4*(p + 1)^2, 0) && Not(IntegerQ(p) && IntegerQ(im*n/2)) && Not(Not(IntegerQ(p)) && IntegerQ((im*n - 1)/2)))
Int(x_*ℯ^(n_'*ArcCot(a_'*x_))/(c_ + d_'*x_^2)^(3/2), x_Symbol) := (-(1 + a*n*x)* ℯ^(n*ArcCot(a*x))/(a^2*c*(n^2 + 1)*Sqrt(c + d*x^2)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && Not(IntegerQ((im*n - 1)/2)))
Int(x_*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((2*(p + 1) - a*n*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcCot(a*x))/(a^2*c*(n^2 + 4*(p + 1)^2)) + n*(2*p + 3)/(a*c*(n^2 + 4*(p + 1)^2))* Int((c + d*x^2)^(p + 1)*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && LeQ(p, -1) && NeQ(p, -3/2) && NeQ(n^2 + 4*(p + 1)^2, 0) && Not(IntegerQ(p) && IntegerQ(im*n/2)) && Not(Not(IntegerQ(p)) && IntegerQ((im*n - 1)/2)))
Int(x_^2*(c_ + d_'*x_^2)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcCot(a*x))/(a^3*c*n^2*(n^2 + 1)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && EqQ(n^2 - 2*(p + 1), 0) && NeQ(n^2 + 1, 0))
Int(x_^2*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* ℯ^(n*ArcCot(a*x))/(a^3*c*(n^2 + 4*(p + 1)^2)) + (n^2 - 2*(p + 1))/(a^2*c*(n^2 + 4*(p + 1)^2))* Int((c + d*x^2)^(p + 1)*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && LeQ(p, -1) && NeQ(n^2 - 2*(p + 1), 0) && NeQ(n^2 + 4*(p + 1)^2, 0) && Not(IntegerQ(p) && IntegerQ(im*n/2)) && Not(Not(IntegerQ(p)) && IntegerQ((im*n - 1)/2)))
Int(x_^m_'*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p/a^(m + 1)* Subst(Int(ℯ^(n*x)*Cot(x)^(m + 2*(p + 1))/Cos(x)^(2*(p + 1)), x), x, ArcCot(a*x)) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && IntegerQ(m) && LeQ(3, m, -2*(p + 1)) && IntegerQ(p))
Int(u_'*(c_ + d_'*x_^2)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (d^p*Int(u*x^(2*p)*(1 + 1/(a^2*x^2))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n], x) && EqQ(d, a^2*c) && Not(IntegerQ(im*n/2)) && IntegerQ(p))
Int(u_'*(c_ + d_'*x_^2)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((c + d*x^2)^p/(x^(2*p)*(1 + 1/(a^2*x^2))^p)* Int(u*x^(2*p)*(1 + 1/(a^2*x^2))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(d, a^2*c) && Not(IntegerQ(im*n/2)) && Not(IntegerQ(p)))
Int(u_'*(c_ + d_'/x_^2)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (c^p/(im*a)^(2*p)* Int(u/x^(2*p)*(-1 + im*a*x)^(p - im*n/2)*(1 + im*a*x)^(p + im*n/2), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c, a^2*d) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)) && IntegersQ(2*p, p + im*n/2))
Int((c_ + d_'/x_^2)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p* Subst(Int((1 - im*x/a)^(p + im*n/2)*(1 + im*x/a)^(p - im*n/2)/x^2, x), x, 1/x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c, a^2*d) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)) && Not(IntegerQ(2*p) && IntegerQ(p + im*n/2)))
Int(x_^m_'*(c_ + d_'/x_^2)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p* Subst(Int((1 - im*x/a)^(p + im*n/2)*(1 + im*x/a)^(p - im*n/2)/ x^(m + 2), x), x, 1/x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c, a^2*d) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)) && Not(IntegerQ(2*p) && IntegerQ(p + im*n/2)) && IntegerQ(m))
Int(x_^m_*(c_ + d_'/x_^2)^p_'*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := (-c^p*x^m*(1/x)^m* Subst(Int((1 - im*x/a)^(p + im*n/2)*(1 + im*x/a)^(p - im*n/2)/ x^(m + 2), x), x, 1/x) <-- FreeQ([a, c, d, m, n, p], x) && EqQ(c, a^2*d) && Not(IntegerQ(im*n/2)) && (IntegerQ(p) || GtQ(c, 0)) && Not(IntegerQ(2*p) && IntegerQ(p + im*n/2)) && Not(IntegerQ(m)))
Int(u_'*(c_ + d_'/x_^2)^p_*ℯ^(n_'*ArcCot(a_'*x_)), x_Symbol) := ((c + d/x^2)^p/(1 + 1/(a^2*x^2))^p* Int(u*(1 + 1/(a^2*x^2))^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, c, d, n, p], x) && EqQ(c, a^2*d) && Not(IntegerQ(im*n/2)) && Not(IntegerQ(p) || GtQ(c, 0)))
Int(u_'*ℯ^(n_*ArcCot(c_'*(a_ + b_'*x_))), x_Symbol) := ((-1)^(im*n/2)*Int(u*ℯ^(-n*ArcTan(c*(a + b*x))), x) <-- FreeQ([a, b, c], x) && IntegerQ(im*n/2))
Int(ℯ^(n_'*ArcCot(c_'*(a_ + b_'*x_))), x_Symbol) := ((im*c*(a + b*x))^(im* n/2)*(1 + 1/(im*c*(a + b*x)))^(im*n/2)/(1 + im*a*c + im*b*c*x)^(im* n/2)* Int((1 + im*a*c + im*b*c*x)^(im*n/2)/(-1 + im*a*c + im*b*c*x)^(im* n/2), x) <-- FreeQ([a, b, c, n], x) && Not(IntegerQ(im*n/2)))
Int(x_^m_*ℯ^(n_*ArcCoth(c_'*(a_ + b_'*x_))), x_Symbol) := (4/(im^m*n*b^(m + 1)*c^(m + 1))* Subst( Int(x^(2/(im*n))*(1 + im*a*c + (1 - im*a*c)*x^(2/(im*n)))^ m/(-1 + x^(2/(im*n)))^(m + 2), x), x, (1 + 1/(im*c*(a + b*x)))^(im*n/2)/(1 - 1/(im*c*(a + b*x)))^(im* n/2)) <-- FreeQ([a, b, c], x) && ILtQ(m, 0) && LtQ(-1, im*n, 1))
Int((d_' + e_'*x_)^m_'*ℯ^(n_'*ArcCoth(c_'*(a_ + b_'*x_))), x_Symbol) := ((im*c*(a + b*x))^(im* n/2)*(1 + 1/(im*c*(a + b*x)))^(im*n/2)/(1 + im*a*c + im*b*c*x)^(im* n/2)* Int((d + e*x)^ m*(1 + im*a*c + im*b*c*x)^(im*n/2)/(-1 + im*a*c + im*b*c*x)^(im*n/2), x) <-- FreeQ([a, b, c, d, e, m, n], x) && Not(IntegerQ(im*n/2)))
Int(u_'*(c_ + d_'*x_ + e_'*x_^2)^p_'*ℯ^(n_'*ArcCot(a_ + b_'*x_)), x_Symbol) := ((c/(1 + a^2))^ p*((im*a + im*b*x)/(1 + im*a + im*b*x))^(im* n/2)*((1 + im*a + im*b*x)/(im*a + im*b*x))^(im*n/2)* ((1 - im*a - im*b*x)^(im*n/2)/(-1 + im*a + im*b*x)^(im*n/2))* Int( u*(1 - im*a - im*b*x)^(p - im*n/2)*(1 + im*a + im*b*x)^(p + im*n/2), x) <-- FreeQ([a, b, c, d, e, n, p], x) && Not(IntegerQ(im*n/2)) && EqQ(b*d - 2*a*e, 0) && EqQ(b^2*c - e*(1 + a^2), 0) && (IntegerQ(p) || GtQ(c/(1 + a^2), 0)))
Int(u_'*(c_ + d_'*x_ + e_'*x_^2)^p_'*ℯ^(n_'*ArcCot(a_ + b_'*x_)), x_Symbol) := ((c + d*x + e*x^2)^p/(1 + a^2 + 2*a*b*x + b^2*x^2)^p* Int(u*(1 + a^2 + 2*a*b*x + b^2*x^2)^p*ℯ^(n*ArcCot(a*x)), x) <-- FreeQ([a, b, c, d, e, n, p], x) && Not(IntegerQ(im*n/2)) && EqQ(b*d - 2*a*e, 0) && EqQ(b^2*c - e*(1 + a^2), 0) && Not(IntegerQ(p) || GtQ(c/(1 + a^2), 0)))
Int(u_'*ℯ^(n_'*ArcCot(c_'/(a_' + b_'*x_))), x_Symbol) := (Int(u*ℯ^(n*ArcTan(a/c + b*x/c)), x) <-- FreeQ([a, b, c, n], x))
end

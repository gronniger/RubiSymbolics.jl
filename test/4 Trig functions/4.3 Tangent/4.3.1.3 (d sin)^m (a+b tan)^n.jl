@testset "4.3.1.3 (d sin)^m (a+b tan)^n" begin
    (a, b, c, d, m, n, x, ) = @variables a b c d m n x

    #= ::Package:: =#

    #= ::Title:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^m*(a+b*tan(e+f*x))^n=#


    #= ::Section::Closed:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^m*(a+b*tan(e+f*x))^n*with*a^2+b^2=0=#


    #= ::Subsection::Closed:: =#
    #=Integrands*of*the*form*sin(e+f*x)^m*(a+a*im*tan(e+f*x))^n=#


    #= ::Subsubsection:: =#
    #=n>0=#


    #= ::Subsubsection::Closed:: =#
    #=n<0=#


    @test_int [sin(x)^4/(im + tan(x)), x, 5, -((im*x)/16) - 1/(32*(im - tan(x))^2) - im/(8*(im - tan(x))) + im/(24*(im + tan(x))^3) - 5/(32*(im + tan(x))^2) - (3*im)/(16*(im + tan(x)))]
    @test_int [sin(x)^3/(im + tan(x)), x, 9, (1/3)*im*cos(x)^3 - (1/5)*im*cos(x)^5 + sin(x)^5/5]
    @test_int [sin(x)^2/(im + tan(x)), x, 5, -((im*x)/8) - im/(8*(im - tan(x))) - 1/(8*(im + tan(x))^2) - im/(4*(im + tan(x)))]
    @test_int [sin(x)^1/(im + tan(x)), x, 8, (1/3)*im*cos(x)^3 + sin(x)^3/3]
    @test_int [csc(x)^1/(im + tan(x)), x, 8, im*atanh(cos(x)) - im*cos(x) + sin(x)]
    @test_int [csc(x)^2/(im + tan(x)), x, 3, im*x + im*cot(x) + log(cos(x)) + log(tan(x))]
    @test_int [csc(x)^3/(im + tan(x)), x, 8, (-(1/2))*im*atanh(cos(x)) - csc(x) + (1/2)*im*cot(x)*csc(x)]
    @test_int [csc(x)^4/(im + tan(x)), x, 4, (-(1/2))*cot(x)^2 + (1/3)*im*cot(x)^3]
    @test_int [csc(x)^5/(im + tan(x)), x, 9, (-(1/8))*im*atanh(cos(x)) - (1/8)*im*cot(x)*csc(x) - csc(x)^3/3 + (1/4)*im*cot(x)*csc(x)^3]
    @test_int [csc(x)^6/(im + tan(x)), x, 4, (-(1/2))*cot(x)^2 + (1/3)*im*cot(x)^3 - cot(x)^4/4 + (1/5)*im*cot(x)^5]


    #= ::Section::Closed:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^m*(a+b*tan(e+f*x))^n=#


    #= ::Subsection::Closed:: =#
    #=Integrands*of*the*form*sin(e+f*x)^m*(a+b*tan(e+f*x))^n=#


    #= ::Subsubsection::Closed:: =#
    #=n>0=#


    @test_int [sin(c + d*x)^5*(a + b*tan(c + d*x)), x, 8, (b*atanh(sin(c + d*x)))/d - (a*cos(c + d*x))/d + (2*a*cos(c + d*x)^3)/(3*d) - (a*cos(c + d*x)^5)/(5*d) - (b*sin(c + d*x))/d - (b*sin(c + d*x)^3)/(3*d) - (b*sin(c + d*x)^5)/(5*d)]
    @test_int [sin(c + d*x)^4*(a + b*tan(c + d*x)), x, 6, (3*a*x)/8 - (b*log(cos(c + d*x)))/d - (cos(c + d*x)*sin(c + d*x)^3*(a + b*tan(c + d*x)))/(4*d) - (cos(c + d*x)*sin(c + d*x)*(3*a + 4*b*tan(c + d*x)))/(8*d)]
    @test_int [sin(c + d*x)^3*(a + b*tan(c + d*x)), x, 8, (b*atanh(sin(c + d*x)))/d - (a*cos(c + d*x))/d + (a*cos(c + d*x)^3)/(3*d) - (b*sin(c + d*x))/d - (b*sin(c + d*x)^3)/(3*d)]
    @test_int [sin(c + d*x)^2*(a + b*tan(c + d*x)), x, 5, (a*x)/2 - (b*log(cos(c + d*x)))/d - (cos(c + d*x)*sin(c + d*x)*(a + b*tan(c + d*x)))/(2*d)]
    @test_int [sin(c + d*x)^1*(a + b*tan(c + d*x)), x, 6, (b*atanh(sin(c + d*x)))/d - (a*cos(c + d*x))/d - (b*sin(c + d*x))/d]
    @test_int [csc(c + d*x)^1*(a + b*tan(c + d*x)), x, 4, -((a*atanh(cos(c + d*x)))/d) + (b*atanh(sin(c + d*x)))/d]
    @test_int [csc(c + d*x)^2*(a + b*tan(c + d*x)), x, 3, -((a*cot(c + d*x))/d) + (b*log(tan(c + d*x)))/d]
    @test_int [csc(c + d*x)^3*(a + b*tan(c + d*x)), x, 7, -((a*atanh(cos(c + d*x)))/(2*d)) + (b*atanh(sin(c + d*x)))/d - (b*csc(c + d*x))/d - (a*cot(c + d*x)*csc(c + d*x))/(2*d)]
    @test_int [csc(c + d*x)^4*(a + b*tan(c + d*x)), x, 3, -((a*cot(c + d*x))/d) - (b*cot(c + d*x)^2)/(2*d) - (a*cot(c + d*x)^3)/(3*d) + (b*log(tan(c + d*x)))/d]
    @test_int [csc(c + d*x)^5*(a + b*tan(c + d*x)), x, 9, -((3*a*atanh(cos(c + d*x)))/(8*d)) + (b*atanh(sin(c + d*x)))/d - (b*csc(c + d*x))/d - (3*a*cot(c + d*x)*csc(c + d*x))/(8*d) - (b*csc(c + d*x)^3)/(3*d) - (a*cot(c + d*x)*csc(c + d*x)^3)/(4*d)]
    @test_int [csc(c + d*x)^6*(a + b*tan(c + d*x)), x, 3, -((a*cot(c + d*x))/d) - (b*cot(c + d*x)^2)/d - (2*a*cot(c + d*x)^3)/(3*d) - (b*cot(c + d*x)^4)/(4*d) - (a*cot(c + d*x)^5)/(5*d) + (b*log(tan(c + d*x)))/d]


    @test_int [sin(c + d*x)^4*(a + b*tan(c + d*x))^2, x, 8, (3/8)*(a^2 - 5*b^2)*x - (2*a*b*log(cos(c + d*x)))/d + (b^2*tan(c + d*x))/d + (cos(c + d*x)^2*(7*b - 5*a*tan(c + d*x))*(a + b*tan(c + d*x)))/(8*d) + (cos(c + d*x)^3*sin(c + d*x)*(a + b*tan(c + d*x))^2)/(4*d)]
    @test_int [sin(c + d*x)^3*(a + b*tan(c + d*x))^2, x, 11, (2*a*b*atanh(sin(c + d*x)))/d - (a^2*cos(c + d*x))/d + (2*b^2*cos(c + d*x))/d + (a^2*cos(c + d*x)^3)/(3*d) - (b^2*cos(c + d*x)^3)/(3*d) + (b^2*sec(c + d*x))/d - (2*a*b*sin(c + d*x))/d - (2*a*b*sin(c + d*x)^3)/(3*d)]
    @test_int [sin(c + d*x)^2*(a + b*tan(c + d*x))^2, x, 6, (1/2)*(a^2 - 3*b^2)*x - (2*a*b*log(cos(c + d*x)))/d + (3*b^2*tan(c + d*x))/(2*d) - (cos(c + d*x)*sin(c + d*x)*(a + b*tan(c + d*x))^2)/(2*d)]
    @test_int [sin(c + d*x)^1*(a + b*tan(c + d*x))^2, x, 9, (2*a*b*atanh(sin(c + d*x)))/d - (a^2*cos(c + d*x))/d + (b^2*cos(c + d*x))/d + (b^2*sec(c + d*x))/d - (2*a*b*sin(c + d*x))/d]
    @test_int [csc(c + d*x)^1*(a + b*tan(c + d*x))^2, x, 6, -((a^2*atanh(cos(c + d*x)))/d) + (2*a*b*atanh(sin(c + d*x)))/d + (b^2*sec(c + d*x))/d]
    @test_int [csc(c + d*x)^2*(a + b*tan(c + d*x))^2, x, 3, -((a^2*cot(c + d*x))/d) + (2*a*b*log(tan(c + d*x)))/d + (b^2*tan(c + d*x))/d]
    @test_int [csc(c + d*x)^3*(a + b*tan(c + d*x))^2, x, 10, -((a^2*atanh(cos(c + d*x)))/(2*d)) - (b^2*atanh(cos(c + d*x)))/d + (2*a*b*atanh(sin(c + d*x)))/d - (2*a*b*csc(c + d*x))/d - (a^2*cot(c + d*x)*csc(c + d*x))/(2*d) + (b^2*sec(c + d*x))/d]
    @test_int [csc(c + d*x)^4*(a + b*tan(c + d*x))^2, x, 3, -(((a^2 + b^2)*cot(c + d*x))/d) - (a*b*cot(c + d*x)^2)/d - (a^2*cot(c + d*x)^3)/(3*d) + (2*a*b*log(tan(c + d*x)))/d + (b^2*tan(c + d*x))/d]
    @test_int [csc(c + d*x)^5*(a + b*tan(c + d*x))^2, x, 13, -((3*a^2*atanh(cos(c + d*x)))/(8*d)) - (3*b^2*atanh(cos(c + d*x)))/(2*d) + (2*a*b*atanh(sin(c + d*x)))/d - (2*a*b*csc(c + d*x))/d - (3*a^2*cot(c + d*x)*csc(c + d*x))/(8*d) - (2*a*b*csc(c + d*x)^3)/(3*d) - (a^2*cot(c + d*x)*csc(c + d*x)^3)/(4*d) + (3*b^2*sec(c + d*x))/(2*d) - (b^2*csc(c + d*x)^2*sec(c + d*x))/(2*d)]
    @test_int [csc(c + d*x)^6*(a + b*tan(c + d*x))^2, x, 3, -(((a^2 + 2*b^2)*cot(c + d*x))/d) - (2*a*b*cot(c + d*x)^2)/d - ((2*a^2 + b^2)*cot(c + d*x)^3)/(3*d) - (a*b*cot(c + d*x)^4)/(2*d) - (a^2*cot(c + d*x)^5)/(5*d) + (2*a*b*log(tan(c + d*x)))/d + (b^2*tan(c + d*x))/d]


    @test_int [sin(c + d*x)^3*(a + b*tan(c + d*x))^3, x, 16, (3*a^2*b*atanh(sin(c + d*x)))/d - (5*b^3*atanh(sin(c + d*x)))/(2*d) - (a^3*cos(c + d*x))/d + (6*a*b^2*cos(c + d*x))/d + (a^3*cos(c + d*x)^3)/(3*d) - (a*b^2*cos(c + d*x)^3)/d + (3*a*b^2*sec(c + d*x))/d - (3*a^2*b*sin(c + d*x))/d + (5*b^3*sin(c + d*x))/(2*d) - (a^2*b*sin(c + d*x)^3)/d + (5*b^3*sin(c + d*x)^3)/(6*d) + (b^3*sin(c + d*x)^3*tan(c + d*x)^2)/(2*d)]
    @test_int [sin(c + d*x)^2*(a + b*tan(c + d*x))^3, x, 7, (1/2)*a*(a^2 - 9*b^2)*x - (b*(3*a^2 - 2*b^2)*log(cos(c + d*x)))/d + (9*a*b^2*tan(c + d*x))/(2*d) + (b^3*tan(c + d*x)^2)/d - (cos(c + d*x)*sin(c + d*x)*(a + b*tan(c + d*x))^3)/(2*d)]
    @test_int [sin(c + d*x)^1*(a + b*tan(c + d*x))^3, x, 13, (3*a^2*b*atanh(sin(c + d*x)))/d - (3*b^3*atanh(sin(c + d*x)))/(2*d) - (a^3*cos(c + d*x))/d + (3*a*b^2*cos(c + d*x))/d + (3*a*b^2*sec(c + d*x))/d - (3*a^2*b*sin(c + d*x))/d + (3*b^3*sin(c + d*x))/(2*d) + (b^3*sin(c + d*x)*tan(c + d*x)^2)/(2*d)]
    @test_int [csc(c + d*x)^1*(a + b*tan(c + d*x))^3, x, 8, -((a^3*atanh(cos(c + d*x)))/d) + (3*a^2*b*atanh(sin(c + d*x)))/d - (b^3*atanh(sin(c + d*x)))/(2*d) + (3*a*b^2*sec(c + d*x))/d + (b^3*sec(c + d*x)*tan(c + d*x))/(2*d)]
    @test_int [csc(c + d*x)^2*(a + b*tan(c + d*x))^3, x, 3, -((a^3*cot(c + d*x))/d) + (3*a^2*b*log(tan(c + d*x)))/d + (3*a*b^2*tan(c + d*x))/d + (b^3*tan(c + d*x)^2)/(2*d)]
    @test_int [csc(c + d*x)^3*(a + b*tan(c + d*x))^3, x, 12, -((a^3*atanh(cos(c + d*x)))/(2*d)) - (3*a*b^2*atanh(cos(c + d*x)))/d + (3*a^2*b*atanh(sin(c + d*x)))/d + (b^3*atanh(sin(c + d*x)))/(2*d) - (3*a^2*b*csc(c + d*x))/d - (a^3*cot(c + d*x)*csc(c + d*x))/(2*d) + (3*a*b^2*sec(c + d*x))/d + (b^3*sec(c + d*x)*tan(c + d*x))/(2*d)]
    @test_int [csc(c + d*x)^4*(a + b*tan(c + d*x))^3, x, 3, -((a*(a^2 + 3*b^2)*cot(c + d*x))/d) - (3*a^2*b*cot(c + d*x)^2)/(2*d) - (a^3*cot(c + d*x)^3)/(3*d) + (b*(3*a^2 + b^2)*log(tan(c + d*x)))/d + (3*a*b^2*tan(c + d*x))/d + (b^3*tan(c + d*x)^2)/(2*d)]
    @test_int [csc(c + d*x)^5*(a + b*tan(c + d*x))^3, x, 17, -((3*a^3*atanh(cos(c + d*x)))/(8*d)) - (9*a*b^2*atanh(cos(c + d*x)))/(2*d) + (3*a^2*b*atanh(sin(c + d*x)))/d + (3*b^3*atanh(sin(c + d*x)))/(2*d) - (3*a^2*b*csc(c + d*x))/d - (3*b^3*csc(c + d*x))/(2*d) - (3*a^3*cot(c + d*x)*csc(c + d*x))/(8*d) - (a^2*b*csc(c + d*x)^3)/d - (a^3*cot(c + d*x)*csc(c + d*x)^3)/(4*d) + (9*a*b^2*sec(c + d*x))/(2*d) - (3*a*b^2*csc(c + d*x)^2*sec(c + d*x))/(2*d) + (b^3*csc(c + d*x)*sec(c + d*x)^2)/(2*d)]
    @test_int [csc(c + d*x)^6*(a + b*tan(c + d*x))^3, x, 3, -((a*(a^2 + 6*b^2)*cot(c + d*x))/d) - (b*(6*a^2 + b^2)*cot(c + d*x)^2)/(2*d) - (a*(2*a^2 + 3*b^2)*cot(c + d*x)^3)/(3*d) - (3*a^2*b*cot(c + d*x)^4)/(4*d) - (a^3*cot(c + d*x)^5)/(5*d) + (b*(3*a^2 + 2*b^2)*log(tan(c + d*x)))/d + (3*a*b^2*tan(c + d*x))/d + (b^3*tan(c + d*x)^2)/(2*d)]


    @test_int [sin(c + d*x)^3*(a + b*tan(c + d*x))^4, x, 19, (4*a^3*b*atanh(sin(c + d*x)))/d - (10*a*b^3*atanh(sin(c + d*x)))/d - (a^4*cos(c + d*x))/d + (12*a^2*b^2*cos(c + d*x))/d - (3*b^4*cos(c + d*x))/d + (a^4*cos(c + d*x)^3)/(3*d) - (2*a^2*b^2*cos(c + d*x)^3)/d + (b^4*cos(c + d*x)^3)/(3*d) + (6*a^2*b^2*sec(c + d*x))/d - (3*b^4*sec(c + d*x))/d + (b^4*sec(c + d*x)^3)/(3*d) - (4*a^3*b*sin(c + d*x))/d + (10*a*b^3*sin(c + d*x))/d - (4*a^3*b*sin(c + d*x)^3)/(3*d) + (10*a*b^3*sin(c + d*x)^3)/(3*d) + (2*a*b^3*sin(c + d*x)^3*tan(c + d*x)^2)/d]
    @test_int [sin(c + d*x)^2*(a + b*tan(c + d*x))^4, x, 7, (1/2)*(a^4 - 18*a^2*b^2 + 5*b^4)*x - (4*a*b*(a^2 - 2*b^2)*log(cos(c + d*x)))/d + (b^2*(18*a^2 - 5*b^2)*tan(c + d*x))/(2*d) + (4*a*b^3*tan(c + d*x)^2)/d + (5*b^4*tan(c + d*x)^3)/(6*d) - (cos(c + d*x)*sin(c + d*x)*(a + b*tan(c + d*x))^4)/(2*d)]
    @test_int [sin(c + d*x)^1*(a + b*tan(c + d*x))^4, x, 16, (4*a^3*b*atanh(sin(c + d*x)))/d - (6*a*b^3*atanh(sin(c + d*x)))/d - (a^4*cos(c + d*x))/d + (6*a^2*b^2*cos(c + d*x))/d - (b^4*cos(c + d*x))/d + (6*a^2*b^2*sec(c + d*x))/d - (2*b^4*sec(c + d*x))/d + (b^4*sec(c + d*x)^3)/(3*d) - (4*a^3*b*sin(c + d*x))/d + (6*a*b^3*sin(c + d*x))/d + (2*a*b^3*sin(c + d*x)*tan(c + d*x)^2)/d]
    @test_int [csc(c + d*x)^1*(a + b*tan(c + d*x))^4, x, 10, -((a^4*atanh(cos(c + d*x)))/d) + (4*a^3*b*atanh(sin(c + d*x)))/d - (2*a*b^3*atanh(sin(c + d*x)))/d + (6*a^2*b^2*sec(c + d*x))/d - (b^4*sec(c + d*x))/d + (b^4*sec(c + d*x)^3)/(3*d) + (2*a*b^3*sec(c + d*x)*tan(c + d*x))/d]
    @test_int [csc(c + d*x)^2*(a + b*tan(c + d*x))^4, x, 3, -((a^4*cot(c + d*x))/d) + (4*a^3*b*log(tan(c + d*x)))/d + (6*a^2*b^2*tan(c + d*x))/d + (2*a*b^3*tan(c + d*x)^2)/d + (b^4*tan(c + d*x)^3)/(3*d)]
    @test_int [csc(c + d*x)^3*(a + b*tan(c + d*x))^4, x, 14, -((a^4*atanh(cos(c + d*x)))/(2*d)) - (6*a^2*b^2*atanh(cos(c + d*x)))/d + (4*a^3*b*atanh(sin(c + d*x)))/d + (2*a*b^3*atanh(sin(c + d*x)))/d - (4*a^3*b*csc(c + d*x))/d - (a^4*cot(c + d*x)*csc(c + d*x))/(2*d) + (6*a^2*b^2*sec(c + d*x))/d + (b^4*sec(c + d*x)^3)/(3*d) + (2*a*b^3*sec(c + d*x)*tan(c + d*x))/d]
    @test_int [csc(c + d*x)^4*(a + b*tan(c + d*x))^4, x, 3, -((a^2*(a^2 + 6*b^2)*cot(c + d*x))/d) - (2*a^3*b*cot(c + d*x)^2)/d - (a^4*cot(c + d*x)^3)/(3*d) + (4*a*b*(a^2 + b^2)*log(tan(c + d*x)))/d + (b^2*(6*a^2 + b^2)*tan(c + d*x))/d + (2*a*b^3*tan(c + d*x)^2)/d + (b^4*tan(c + d*x)^3)/(3*d)]
    @test_int [csc(c + d*x)^5*(a + b*tan(c + d*x))^4, x, 21, -((3*a^4*atanh(cos(c + d*x)))/(8*d)) - (9*a^2*b^2*atanh(cos(c + d*x)))/d - (b^4*atanh(cos(c + d*x)))/d + (4*a^3*b*atanh(sin(c + d*x)))/d + (6*a*b^3*atanh(sin(c + d*x)))/d - (4*a^3*b*csc(c + d*x))/d - (6*a*b^3*csc(c + d*x))/d - (3*a^4*cot(c + d*x)*csc(c + d*x))/(8*d) - (4*a^3*b*csc(c + d*x)^3)/(3*d) - (a^4*cot(c + d*x)*csc(c + d*x)^3)/(4*d) + (9*a^2*b^2*sec(c + d*x))/d + (b^4*sec(c + d*x))/d - (3*a^2*b^2*csc(c + d*x)^2*sec(c + d*x))/d + (2*a*b^3*csc(c + d*x)*sec(c + d*x)^2)/d + (b^4*sec(c + d*x)^3)/(3*d)]
    @test_int [csc(c + d*x)^6*(a + b*tan(c + d*x))^4, x, 3, -(((a^4 + 12*a^2*b^2 + b^4)*cot(c + d*x))/d) - (2*a*b*(2*a^2 + b^2)*cot(c + d*x)^2)/d - (2*a^2*(a^2 + 3*b^2)*cot(c + d*x)^3)/(3*d) - (a^3*b*cot(c + d*x)^4)/d - (a^4*cot(c + d*x)^5)/(5*d) + (4*a*b*(a^2 + 2*b^2)*log(tan(c + d*x)))/d + (2*b^2*(3*a^2 + b^2)*tan(c + d*x))/d + (2*a*b^3*tan(c + d*x)^2)/d + (b^4*tan(c + d*x)^3)/(3*d)]
    @test_int [csc(c + d*x)^7*(a + b*tan(c + d*x))^4, x, 25, -((5*a^4*atanh(cos(c + d*x)))/(16*d)) - (45*a^2*b^2*atanh(cos(c + d*x)))/(4*d) - (5*b^4*atanh(cos(c + d*x)))/(2*d) + (4*a^3*b*atanh(sin(c + d*x)))/d + (10*a*b^3*atanh(sin(c + d*x)))/d - (4*a^3*b*csc(c + d*x))/d - (10*a*b^3*csc(c + d*x))/d - (5*a^4*cot(c + d*x)*csc(c + d*x))/(16*d) - (4*a^3*b*csc(c + d*x)^3)/(3*d) - (10*a*b^3*csc(c + d*x)^3)/(3*d) - (5*a^4*cot(c + d*x)*csc(c + d*x)^3)/(24*d) - (4*a^3*b*csc(c + d*x)^5)/(5*d) - (a^4*cot(c + d*x)*csc(c + d*x)^5)/(6*d) + (45*a^2*b^2*sec(c + d*x))/(4*d) + (5*b^4*sec(c + d*x))/(2*d) - (15*a^2*b^2*csc(c + d*x)^2*sec(c + d*x))/(4*d) - (3*a^2*b^2*csc(c + d*x)^4*sec(c + d*x))/(2*d) + (2*a*b^3*csc(c + d*x)^3*sec(c + d*x)^2)/d + (5*b^4*sec(c + d*x)^3)/(6*d) - (b^4*csc(c + d*x)^2*sec(c + d*x)^3)/(2*d)]


    #= ::Subsubsection::Closed:: =#
    #=n<0=#


    @test_int [sin(c + d*x)^5/(a + b*tan(c + d*x)), x, 13, (a^5*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(7/2)*d) + (a^3*b^2*cos(c + d*x))/((a^2 + b^2)^3*d) + (a*b^2*cos(c + d*x))/((a^2 + b^2)^2*d) - (a*cos(c + d*x))/((a^2 + b^2)*d) - (a*b^2*cos(c + d*x)^3)/(3*(a^2 + b^2)^2*d) + (2*a*cos(c + d*x)^3)/(3*(a^2 + b^2)*d) - (a*cos(c + d*x)^5)/(5*(a^2 + b^2)*d) + (a^4*b*sin(c + d*x))/((a^2 + b^2)^3*d) + (a^2*b*sin(c + d*x)^3)/(3*(a^2 + b^2)^2*d) + (b*sin(c + d*x)^5)/(5*(a^2 + b^2)*d)]
    @test_int [sin(c + d*x)^4/(a + b*tan(c + d*x)), x, 8, (a*(3*a^4 - 6*a^2*b^2 - b^4)*x)/(8*(a^2 + b^2)^3) + (a^4*b*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^3*d) + (cos(c + d*x)^4*(b + a*tan(c + d*x)))/(4*(a^2 + b^2)*d) - (cos(c + d*x)^2*(4*b*(2*a^2 + b^2) + a*(5*a^2 + b^2)*tan(c + d*x)))/(8*(a^2 + b^2)^2*d)]
    @test_int [sin(c + d*x)^3/(a + b*tan(c + d*x)), x, 10, (a^3*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(5/2)*d) + (a*b^2*cos(c + d*x))/((a^2 + b^2)^2*d) - (a*cos(c + d*x))/((a^2 + b^2)*d) + (a*cos(c + d*x)^3)/(3*(a^2 + b^2)*d) + (a^2*b*sin(c + d*x))/((a^2 + b^2)^2*d) + (b*sin(c + d*x)^3)/(3*(a^2 + b^2)*d)]
    @test_int [sin(c + d*x)^2/(a + b*tan(c + d*x)), x, 7, (a*(a^2 - b^2)*x)/(2*(a^2 + b^2)^2) + (a^2*b*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^2*d) - (cos(c + d*x)^2*(b + a*tan(c + d*x)))/(2*(a^2 + b^2)*d)]
    @test_int [sin(c + d*x)^1/(a + b*tan(c + d*x)), x, 6, (a*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(3/2)*d) - (a*cos(c + d*x))/((a^2 + b^2)*d) + (b*sin(c + d*x))/((a^2 + b^2)*d)]
    @test_int [csc(c + d*x)^1/(a + b*tan(c + d*x)), x, 6, -(atanh(cos(c + d*x))/(a*d)) + (b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a*sqrt(a^2 + b^2)*d)]
    @test_int [csc(c + d*x)^2/(a + b*tan(c + d*x)), x, 3, -(cot(c + d*x)/(a*d)) - (b*log(tan(c + d*x)))/(a^2*d) + (b*log(a + b*tan(c + d*x)))/(a^2*d)]
    @test_int [csc(c + d*x)^3/(a + b*tan(c + d*x)), x, 15, -(atanh(cos(c + d*x))/(2*a*d)) - (b^2*atanh(cos(c + d*x)))/(a^3*d) + (b*sqrt(a^2 + b^2)*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^3*d) + (b*csc(c + d*x))/(a^2*d) - (cot(c + d*x)*csc(c + d*x))/(2*a*d)]
    @test_int [csc(c + d*x)^4/(a + b*tan(c + d*x)), x, 3, -(((a^2 + b^2)*cot(c + d*x))/(a^3*d)) + (b*cot(c + d*x)^2)/(2*a^2*d) - cot(c + d*x)^3/(3*a*d) - (b*(a^2 + b^2)*log(tan(c + d*x)))/(a^4*d) + (b*(a^2 + b^2)*log(a + b*tan(c + d*x)))/(a^4*d)]
    #= [csc(c + d*x)^5/(a + b*tan(c + d*x)), x, 25, -((3*atanh(cos(c + d*x)))/(8*a*d)) - (3*b^2*atanh(cos(c + d*x)))/(2*a^3*d) - (b^4*atanh(cos(c + d*x)))/(a^5*d) - (b*atanh(sin(c + d*x)))/(a^2*d) - (b^3*atanh(sin(c + d*x)))/(a^4*d) + (b*(a^2 + b^2)*atanh(sin(c + d*x)))/(a^4*d) + (b*(a^2 + b^2)^(3/2)*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^5*d) + (b*csc(c + d*x))/(a^2*d) + (3*b^3*csc(c + d*x))/(2*a^4*d) - (3*cot(c + d*x)*csc(c + d*x))/(8*a*d) + (b*csc(c + d*x)^3)/(3*a^2*d) - (cot(c + d*x)*csc(c + d*x)^3)/(4*a*d) + (3*b^2*sec(c + d*x))/(2*a^3*d) + (b^4*sec(c + d*x))/(a^5*d) - (b^2*(a^2 + b^2)*sec(c + d*x))/(a^5*d) - (b^2*csc(c + d*x)^2*sec(c + d*x))/(2*a^3*d) - (b^3*csc(c + d*x)*sec(c + d*x)^2)/(2*a^4*d) + (b^3*sec(c + d*x)*tan(c + d*x))/(2*a^4*d)] =#
    @test_int [csc(c + d*x)^6/(a + b*tan(c + d*x)), x, 3, -(((a^2 + b^2)^2*cot(c + d*x))/(a^5*d)) + (b*(2*a^2 + b^2)*cot(c + d*x)^2)/(2*a^4*d) - ((2*a^2 + b^2)*cot(c + d*x)^3)/(3*a^3*d) + (b*cot(c + d*x)^4)/(4*a^2*d) - cot(c + d*x)^5/(5*a*d) - (b*(a^2 + b^2)^2*log(tan(c + d*x)))/(a^6*d) + (b*(a^2 + b^2)^2*log(a + b*tan(c + d*x)))/(a^6*d)]


    @test_int [sin(c + d*x)^6/(a + b*tan(c + d*x))^2, x, 9, ((5*a^8 - 80*a^6*b^2 + 50*a^4*b^4 + 8*a^2*b^6 + b^8)*x)/(16*(a^2 + b^2)^5) + (2*a^5*b*(a^2 - 3*b^2)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^5*d) - (a^6*b)/((a^2 + b^2)^4*d*(a + b*tan(c + d*x))) - (cos(c + d*x)^6*(2*a*b + (a^2 - b^2)*tan(c + d*x)))/(6*(a^2 + b^2)^2*d) + (cos(c + d*x)^4*(12*a*b*(3*a^2 + b^2) + (13*a^4 - 18*a^2*b^2 - 7*b^4)*tan(c + d*x)))/(24*(a^2 + b^2)^3*d) - (cos(c + d*x)^2*(48*a^5*b + (11*a^6 - 43*a^4*b^2 - 7*a^2*b^4 - b^6)*tan(c + d*x)))/(16*(a^2 + b^2)^4*d)]
    @test_int [sin(c + d*x)^4/(a + b*tan(c + d*x))^2, x, 8, ((3*a^6 - 33*a^4*b^2 + 13*a^2*b^4 + b^6)*x)/(8*(a^2 + b^2)^4) + (2*a^3*b*(a^2 - 2*b^2)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^4*d) - (a^4*b)/((a^2 + b^2)^3*d*(a + b*tan(c + d*x))) + (cos(c + d*x)^4*(2*a*b + (a^2 - b^2)*tan(c + d*x)))/(4*(a^2 + b^2)^2*d) - (cos(c + d*x)^2*(16*a^3*b + (5*a^4 - 12*a^2*b^2 - b^4)*tan(c + d*x)))/(8*(a^2 + b^2)^3*d)]
    @test_int [sin(c + d*x)^2/(a + b*tan(c + d*x))^2, x, 7, ((a^4 - 6*a^2*b^2 + b^4)*x)/(2*(a^2 + b^2)^3) + (2*a*b*(a^2 - b^2)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^3*d) - (a^2*b)/((a^2 + b^2)^2*d*(a + b*tan(c + d*x))) - (cos(c + d*x)^2*(2*a*b + (a^2 - b^2)*tan(c + d*x)))/(2*(a^2 + b^2)^2*d)]
    @test_int [csc(c + d*x)^2/(a + b*tan(c + d*x))^2, x, 3, -(cot(c + d*x)/(a^2*d)) - (2*b*log(tan(c + d*x)))/(a^3*d) + (2*b*log(a + b*tan(c + d*x)))/(a^3*d) - b/(a^2*d*(a + b*tan(c + d*x)))]
    @test_int [csc(c + d*x)^4/(a + b*tan(c + d*x))^2, x, 3, -(((a^2 + 3*b^2)*cot(c + d*x))/(a^4*d)) + (b*cot(c + d*x)^2)/(a^3*d) - cot(c + d*x)^3/(3*a^2*d) - (2*b*(a^2 + 2*b^2)*log(tan(c + d*x)))/(a^5*d) + (2*b*(a^2 + 2*b^2)*log(a + b*tan(c + d*x)))/(a^5*d) - (b*(a^2 + b^2))/(a^4*d*(a + b*tan(c + d*x)))]
    @test_int [csc(c + d*x)^6/(a + b*tan(c + d*x))^2, x, 3, -(((a^2 + b^2)*(a^2 + 5*b^2)*cot(c + d*x))/(a^6*d)) + (2*b*(a^2 + b^2)*cot(c + d*x)^2)/(a^5*d) - ((2*a^2 + 3*b^2)*cot(c + d*x)^3)/(3*a^4*d) + (b*cot(c + d*x)^4)/(2*a^3*d) - cot(c + d*x)^5/(5*a^2*d) - (2*b*(a^2 + b^2)*(a^2 + 3*b^2)*log(tan(c + d*x)))/(a^7*d) + (2*b*(a^2 + b^2)*(a^2 + 3*b^2)*log(a + b*tan(c + d*x)))/(a^7*d) - (b*(a^2 + b^2)^2)/(a^6*d*(a + b*tan(c + d*x)))]
    #=
    @test_int [sin(c + d*x)^5/(a + b*tan(c + d*x))^2, x, 0, (5*sec(c + d*x)^2*(a*cos(c + d*x) + b*sin(c + d*x))*(a*(a^2 + b^2) + 2*b*sqrt(a^2 + b^2)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2))*(a*cos(c + d*x) + b*sin(c + d*x))))/(64*(a^2 + b^2)^2*d*(a + b*tan(c + d*x))^2) + (1/(64*(a^2 + b^2)^3*d*(a + b*tan(c + d*x))^2))*(sec(c + d*x)^2*(a*cos(c + d*x) + b*sin(c + d*x))*(6*b*(-3*a^2 + b^2)*sqrt(a^2 + b^2)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2))*(a*cos(c + d*x) + b*sin(c + d*x)) - (a^2 + b^2)*(3*a*(a^2 - 3*b^2) + 2*a*(a^2 + b^2)*cos(2*(c + d*x)) - 2*b*(a^2 + b^2)*sin(2*(c + d*x))))) - (3*sec(c + d*x)^2*(a*cos(c + d*x) + b*sin(c + d*x))^2*((10*b*(5*a^4 - 10*a^2*b^2 + b^4)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2)))/(a^2 + b^2)^(7/2) + (8*(a^4 - 6*a^2*b^2 + b^4)*cos(c + d*x))/(a^2 + b^2)^3 - (4*(a^2 - b^2)*cos(3*(c + d*x)))/(3*(a^2 + b^2)^2) - (32*a*b*(a^2 - b^2)*sin(c + d*x))/(a^2 + b^2)^3 + (a*(a^4 - 10*a^2*b^2 + 5*b^4))/((a^2 + b^2)^3*(a*cos(c + d*x) + b*sin(c + d*x))) + (8*a*b*sin(3*(c + d*x)))/(3*(a^2 + b^2)^2)))/(64*d*(a + b*tan(c + d*x))^2) + (1/(64*d*(a + b*tan(c + d*x))^2))*(sec(c + d*x)^2*(a*cos(c + d*x) + b*sin(c + d*x))^2*((14*b*(-7*a^6 + 35*a^4*b^2 - 21*a^2*b^4 + b^6)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2)))/(a^2 + b^2)^(9/2) - (12*(a^6 - 15*a^4*b^2 + 15*a^2*b^4 - b^6)*cos(c + d*x))/(a^2 + b^2)^4 + (8*(a^4 - 6*a^2*b^2 + b^4)*cos(3*(c + d*x)))/(3*(a^2 + b^2)^3) - (4*(a^2 - b^2)*cos(5*(c + d*x)))/(5*(a^2 + b^2)^2) + (24*a*b*(3*a^4 - 10*a^2*b^2 + 3*b^4)*sin(c + d*x))/(a^2 + b^2)^4 - (a*(a^6 - 21*a^4*b^2 + 35*a^2*b^4 - 7*b^6))/((a^2 + b^2)^4*(a*cos(c + d*x) + b*sin(c + d*x))) - (32*a*b*(a^2 - b^2)*sin(3*(c + d*x)))/(3*(a^2 + b^2)^3) + (8*a*b*sin(5*(c + d*x)))/(5*(a^2 + b^2)^2)))]
    @test_int [sin(c + d*x)^3/(a + b*tan(c + d*x))^2, x, 31, (2*a^4*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(7/2)*d) - (3*a^2*b^3*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(7/2)*d) + (4*a^2*b^2*cos(c + d*x))/((a^2 + b^2)^3*d) - (a^2*cos(c + d*x))/((a^2 + b^2)^2*d) + (a^2*cos(c + d*x)^3)/(3*(a^2 + b^2)^2*d) - (b^2*cos(c + d*x)^3)/(3*(a^2 + b^2)^2*d) + (2*a^3*b*sin(c + d*x))/((a^2 + b^2)^3*d) - (2*a*b^3*sin(c + d*x))/((a^2 + b^2)^3*d) + (2*a*b*sin(c + d*x)^3)/(3*(a^2 + b^2)^2*d) + (a^3*b^2)/((a^2 + b^2)^3*d*(a*cos(c + d*x) + b*sin(c + d*x)))]
    @test_int [sin(c + d*x)^1/(a + b*tan(c + d*x))^2, x, 14, (2*a^2*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(5/2)*d) - (b^3*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(5/2)*d) - (a^2*cos(c + d*x))/((a^2 + b^2)^2*d) + (b^2*cos(c + d*x))/((a^2 + b^2)^2*d) + (2*a*b*sin(c + d*x))/((a^2 + b^2)^2*d) + (a*b^2)/((a^2 + b^2)^2*d*(a*cos(c + d*x) + b*sin(c + d*x)))]
    @test_int [csc(c + d*x)^1/(a + b*tan(c + d*x))^2, x, 9, -(atanh(cos(c + d*x))/(a^2*d)) + (b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(3/2)*d) + (b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^2*sqrt(a^2 + b^2)*d) + b^2/(a*(a^2 + b^2)*d*(a*cos(c + d*x) + b*sin(c + d*x)))]
    @test_int [csc(c + d*x)^3/(a + b*tan(c + d*x))^2, x, 17, -(atanh(cos(c + d*x))/(2*a^2*d)) - (3*b^2*atanh(cos(c + d*x)))/(a^4*d) - (b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^2*sqrt(a^2 + b^2)*d) + (3*b*sqrt(a^2 + b^2)*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^4*d) + (2*b*csc(c + d*x))/(a^3*d) - (cot(c + d*x)*csc(c + d*x))/(2*a^2*d) + b^2/(a^3*d*(a*cos(c + d*x) + b*sin(c + d*x)))]
    =#


    @test_int [sin(c + d*x)^6/(a + b*tan(c + d*x))^3, x, 9, (a*(5*a^8 - 180*a^6*b^2 + 390*a^4*b^4 - 68*a^2*b^6 - 3*b^8)*x)/(16*(a^2 + b^2)^6) + (a^4*b*(3*a^4 - 22*a^2*b^2 + 15*b^4)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^6*d) - (a^6*b)/(2*(a^2 + b^2)^4*d*(a + b*tan(c + d*x))^2) - (2*a^5*b*(a^2 - 3*b^2))/((a^2 + b^2)^5*d*(a + b*tan(c + d*x))) - (cos(c + d*x)^6*(b*(3*a^2 - b^2) + a*(a^2 - 3*b^2)*tan(c + d*x)))/(6*(a^2 + b^2)^3*d) + (cos(c + d*x)^4*(6*b*(9*a^4 - 4*a^2*b^2 - b^4) + a*(13*a^4 - 62*a^2*b^2 - 3*b^4)*tan(c + d*x)))/(24*(a^2 + b^2)^4*d) - (a*cos(c + d*x)^2*(24*a^3*b*(3*a^2 - 5*b^2) + (11*a^6 - 119*a^4*b^2 + 65*a^2*b^4 + 3*b^6)*tan(c + d*x)))/(16*(a^2 + b^2)^5*d)]
    @test_int [sin(c + d*x)^4/(a + b*tan(c + d*x))^3, x, 8, (3*a*(a^6 - 25*a^4*b^2 + 35*a^2*b^4 - 3*b^6)*x)/(8*(a^2 + b^2)^5) + (3*a^2*b*(a^4 - 5*a^2*b^2 + 2*b^4)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^5*d) - (a^4*b)/(2*(a^2 + b^2)^3*d*(a + b*tan(c + d*x))^2) - (2*a^3*b*(a^2 - 2*b^2))/((a^2 + b^2)^4*d*(a + b*tan(c + d*x))) + (cos(c + d*x)^4*(b*(3*a^2 - b^2) + a*(a^2 - 3*b^2)*tan(c + d*x)))/(4*(a^2 + b^2)^3*d) - (a*cos(c + d*x)^2*(24*a*b*(a^2 - b^2) + (5*a^4 - 34*a^2*b^2 + 9*b^4)*tan(c + d*x)))/(8*(a^2 + b^2)^4*d)]
    @test_int [sin(c + d*x)^2/(a + b*tan(c + d*x))^3, x, 7, (a*(a^4 - 14*a^2*b^2 + 9*b^4)*x)/(2*(a^2 + b^2)^4) + (b*(3*a^4 - 8*a^2*b^2 + b^4)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^4*d) - (a^2*b)/(2*(a^2 + b^2)^2*d*(a + b*tan(c + d*x))^2) - (2*a*b*(a^2 - b^2))/((a^2 + b^2)^3*d*(a + b*tan(c + d*x))) - (cos(c + d*x)^2*(b*(3*a^2 - b^2) + a*(a^2 - 3*b^2)*tan(c + d*x)))/(2*(a^2 + b^2)^3*d)]
    @test_int [csc(c + d*x)^2/(a + b*tan(c + d*x))^3, x, 3, -(cot(c + d*x)/(a^3*d)) - (3*b*log(tan(c + d*x)))/(a^4*d) + (3*b*log(a + b*tan(c + d*x)))/(a^4*d) - b/(2*a^2*d*(a + b*tan(c + d*x))^2) - (2*b)/(a^3*d*(a + b*tan(c + d*x)))]
    @test_int [csc(c + d*x)^4/(a + b*tan(c + d*x))^3, x, 3, -(((a^2 + 6*b^2)*cot(c + d*x))/(a^5*d)) + (3*b*cot(c + d*x)^2)/(2*a^4*d) - cot(c + d*x)^3/(3*a^3*d) - (b*(3*a^2 + 10*b^2)*log(tan(c + d*x)))/(a^6*d) + (b*(3*a^2 + 10*b^2)*log(a + b*tan(c + d*x)))/(a^6*d) - (b*(a^2 + b^2))/(2*a^4*d*(a + b*tan(c + d*x))^2) - (2*b*(a^2 + 2*b^2))/(a^5*d*(a + b*tan(c + d*x)))]
    @test_int [csc(c + d*x)^6/(a + b*tan(c + d*x))^3, x, 3, -(((a^4 + 12*a^2*b^2 + 15*b^4)*cot(c + d*x))/(a^7*d)) + (b*(3*a^2 + 5*b^2)*cot(c + d*x)^2)/(a^6*d) - (2*(a^2 + 3*b^2)*cot(c + d*x)^3)/(3*a^5*d) + (3*b*cot(c + d*x)^4)/(4*a^4*d) - cot(c + d*x)^5/(5*a^3*d) - (b*(3*a^4 + 20*a^2*b^2 + 21*b^4)*log(tan(c + d*x)))/(a^8*d) + (b*(3*a^4 + 20*a^2*b^2 + 21*b^4)*log(a + b*tan(c + d*x)))/(a^8*d) - (b*(a^2 + b^2)^2)/(2*a^6*d*(a + b*tan(c + d*x))^2) - (2*b*(a^2 + b^2)*(a^2 + 3*b^2))/(a^7*d*(a + b*tan(c + d*x)))]
    #=
    @test_int [sin(c + d*x)^5/(a + b*tan(c + d*x))^3, x, 0, (3*sec(c + d*x)^3*(a*cos(c + d*x) + b*sin(c + d*x))*(6*a*b*sqrt(a^2 + b^2)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2))*(a*cos(c + d*x) + b*sin(c + d*x))^2 + (a^2 + b^2)*(a*(2*a^2 - b^2)*cos(c + d*x) + b*(a^2 - 2*b^2)*sin(c + d*x))))/(64*(a^2 + b^2)^3*d*(a + b*tan(c + d*x))^3) + (1/(64*d*(a + b*tan(c + d*x))^3))*(sec(c + d*x)^3*(a*cos(c + d*x) + b*sin(c + d*x))^3*(-((70*a*b*(3*a^4 - 10*a^2*b^2 + 3*b^4)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2)))/(a^2 + b^2)^(9/2)) - (24*a*(a^4 - 10*a^2*b^2 + 5*b^4)*cos(c + d*x))/(a^2 + b^2)^4 + (8*a*(a^2 - 3*b^2)*cos(3*(c + d*x)))/(3*(a^2 + b^2)^3) + (24*b*(5*a^4 - 10*a^2*b^2 + b^4)*sin(c + d*x))/(a^2 + b^2)^4 - (b*(-3*a^4 + 10*a^2*b^2 - 3*b^4)*sin(c + d*x))/((a^2 + b^2)^3*(a*cos(c + d*x) + b*sin(c + d*x))^2) - (6*a^6 - 87*a^4*b^2 + 80*a^2*b^4 - 3*b^6)/((a^2 + b^2)^4*(a*cos(c + d*x) + b*sin(c + d*x))) + (8*b*(-3*a^2 + b^2)*sin(3*(c + d*x)))/(3*(a^2 + b^2)^3))) + (sec(c + d*x)^3*(a*cos(c + d*x) + b*sin(c + d*x))^3*((60*a*b*(a^2 - b^2)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2)))/(a^2 + b^2)^(7/2) + (2*(5*a^3*(a^2 - 5*b^2)*cos(c + d*x) + a*(a^2 + b^2)^2*cos(3*(c + d*x)) - b*(-5*b^2*(-5*a^2 + b^2)*sin(c + d*x) + (a^2 + b^2)^2*sin(3*(c + d*x)))))/((a^2 + b^2)^3*(a*cos(c + d*x) + b*sin(c + d*x))^2)))/(64*d*(a + b*tan(c + d*x))^3) - (1/(320*(a^2 + b^2)^6*d*(a + b*tan(c + d*x))^3))*(sec(c + d*x)^3*(a*cos(c + d*x) + b*sin(c + d*x))*(1260*a*b*sqrt(a^2 + b^2)*(a^6 - 7*a^4*b^2 + 7*a^2*b^4 - b^6)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2))*(a*cos(c + d*x) + b*sin(c + d*x))^2 + (a^2 + b^2)*(105*a*(a^8 - 26*a^6*b^2 + 56*a^4*b^4 - 14*a^2*b^6 - b^8)*cos(c + d*x) + 21*a*(a^2 + b^2)^2*(a^4 - 10*a^2*b^2 + 5*b^4)*cos(3*(c + d*x)) - 3*a^9*cos(5*(c + d*x)) + 18*a^5*b^4*cos(5*(c + d*x)) + 24*a^3*b^6*cos(5*(c + d*x)) + 9*a*b^8*cos(5*(c + d*x)) + a^9*cos(7*(c + d*x)) + 4*a^7*b^2*cos(7*(c + d*x)) + 6*a^5*b^4*cos(7*(c + d*x)) + 4*a^3*b^6*cos(7*(c + d*x)) + a*b^8*cos(7*(c + d*x)) - 105*a^8*b*sin(c + d*x) - 1470*a^6*b^3*sin(c + d*x) + 5880*a^4*b^5*sin(c + d*x) - 2730*a^2*b^7*sin(c + d*x) + 105*b^9*sin(c + d*x) - 105*a^8*b*sin(3*(c + d*x)) + 294*a^4*b^5*sin(3*(c + d*x)) + 168*a^2*b^7*sin(3*(c + d*x)) - 21*b^9*sin(3*(c + d*x)) + 9*a^8*b*sin(5*(c + d*x)) + 24*a^6*b^3*sin(5*(c + d*x)) + 18*a^4*b^5*sin(5*(c + d*x)) - 3*b^9*sin(5*(c + d*x)) - a^8*b*sin(7*(c + d*x)) - 4*a^6*b^3*sin(7*(c + d*x)) - 6*a^4*b^5*sin(7*(c + d*x)) - 4*a^2*b^7*sin(7*(c + d*x)) - b^9*sin(7*(c + d*x)))))]
    @test_int [sin(c + d*x)^3/(a + b*tan(c + d*x))^3, x, 99, (3*a^5*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(9/2)*d) - (23*a^3*b^3*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(2*(a^2 + b^2)^(9/2)*d) + (3*a*b^5*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/((a^2 + b^2)^(9/2)*d) + (9*a^3*b^2*cos(c + d*x))/((a^2 + b^2)^4*d) - (3*a*b^4*cos(c + d*x))/((a^2 + b^2)^4*d) - (a^3*cos(c + d*x))/((a^2 + b^2)^3*d) + (a^3*cos(c + d*x)^3)/(3*(a^2 + b^2)^3*d) - (a*b^2*cos(c + d*x)^3)/((a^2 + b^2)^3*d) + (3*a^4*b*sin(c + d*x))/((a^2 + b^2)^4*d) - (9*a^2*b^3*sin(c + d*x))/((a^2 + b^2)^4*d) + (b^3*sin(c + d*x))/((a^2 + b^2)^3*d) + (a^2*b*sin(c + d*x)^3)/((a^2 + b^2)^3*d) - (b^3*sin(c + d*x)^3)/(3*(a^2 + b^2)^3*d) + (a^3*b^3*(b*cos(c + d*x) - a*sin(c + d*x)))/(2*(a^2 + b^2)^4*d*(a*cos(c + d*x) + b*sin(c + d*x))^2) + (3*a^4*b^2)/((a^2 + b^2)^4*d*(a*cos(c + d*x) + b*sin(c + d*x))) - (3*a^2*b^4)/((a^2 + b^2)^4*d*(a*cos(c + d*x) + b*sin(c + d*x)))]
    @test_int [sin(c + d*x)^1/(a + b*tan(c + d*x))^3, x, 0, -((1/(4*(a^2 + b^2)^(7/2)*d*(a + b*tan(c + d*x))^3))*(sec(c + d*x)^3*(a*cos(c + d*x) + b*sin(c + d*x))*(12*a*b*(2*a^2 - 3*b^2)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2))*(a*cos(c + d*x) + b*sin(c + d*x))^2 + sqrt(a^2 + b^2)*(a*(3*a^4 - 26*a^2*b^2 + b^4)*cos(c + d*x) + a*(a^2 + b^2)^2*cos(3*(c + d*x)) - 2*b*(a^4 + 13*a^2*b^2 - 3*b^4 + (a^2 + b^2)^2*cos(2*(c + d*x)))*sin(c + d*x)))))]
    @test_int [csc(c + d*x)^1/(a + b*tan(c + d*x))^3, x, 0, (1/(2*a^3*d*(a + b*tan(c + d*x))^3))*(sec(c + d*x)^2*(a*cos(c + d*x) + b*sin(c + d*x))*((3*a*b^2*(2*a^2 + b^2)*sec(c + d*x)*(a*cos(c + d*x) + b*sin(c + d*x)))/(a^2 + b^2)^2 - (2*b*(6*a^4 + 5*a^2*b^2 + 2*b^4)*atanh((-b + a*tan((1/2)*(c + d*x)))/sqrt(a^2 + b^2))*sec(c + d*x)*(a*cos(c + d*x) + b*sin(c + d*x))^2)/(a^2 + b^2)^(5/2) - 2*log(cos((1/2)*(c + d*x)))*sec(c + d*x)*(a*cos(c + d*x) + b*sin(c + d*x))^2 + 2*log(sin((1/2)*(c + d*x)))*sec(c + d*x)*(a*cos(c + d*x) + b*sin(c + d*x))^2 - (a*b^3*tan(c + d*x))/(a^2 + b^2)))]
    @test_int [csc(c + d*x)^3/(a + b*tan(c + d*x))^3, x, 20, -(atanh(cos(c + d*x))/(2*a^3*d)) - (6*b^2*atanh(cos(c + d*x)))/(a^5*d) + (b^3*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(2*a^3*(a^2 + b^2)^(3/2)*d) - (3*b*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^3*sqrt(a^2 + b^2)*d) + (6*b*sqrt(a^2 + b^2)*atanh((b*cos(c + d*x) - a*sin(c + d*x))/sqrt(a^2 + b^2)))/(a^5*d) + (3*b*csc(c + d*x))/(a^4*d) - (cot(c + d*x)*csc(c + d*x))/(2*a^3*d) + (b^3*(b*cos(c + d*x) - a*sin(c + d*x)))/(2*a^3*(a^2 + b^2)*d*(a*cos(c + d*x) + b*sin(c + d*x))^2) + (3*b^2)/(a^4*d*(a*cos(c + d*x) + b*sin(c + d*x)))]
    =#


    @test_int [sin(c + d*x)^4/(a + b*tan(c + d*x))^4, x, 8, ((3*a^8 - 132*a^6*b^2 + 370*a^4*b^4 - 132*a^2*b^6 + 3*b^8)*x)/(8*(a^2 + b^2)^6) + (4*a*b*(a^2 - b^2)*(a^4 - 8*a^2*b^2 + b^4)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^6*d) - (a^4*b)/(3*(a^2 + b^2)^3*d*(a + b*tan(c + d*x))^3) - (a^3*b*(a^2 - 2*b^2))/((a^2 + b^2)^4*d*(a + b*tan(c + d*x))^2) - (3*a^2*b*(a^4 - 5*a^2*b^2 + 2*b^4))/((a^2 + b^2)^5*d*(a + b*tan(c + d*x))) + (cos(c + d*x)^4*(4*a*b*(a^2 - b^2) + (a^4 - 6*a^2*b^2 + b^4)*tan(c + d*x)))/(4*(a^2 + b^2)^4*d) - (cos(c + d*x)^2*(16*a*b*(2*a^4 - 5*a^2*b^2 + b^4) + (5*a^6 - 65*a^4*b^2 + 55*a^2*b^4 - 3*b^6)*tan(c + d*x)))/(8*(a^2 + b^2)^5*d)]
    @test_int [sin(c + d*x)^2/(a + b*tan(c + d*x))^4, x, 7, ((a^6 - 25*a^4*b^2 + 35*a^2*b^4 - 3*b^6)*x)/(2*(a^2 + b^2)^5) + (4*a*b*(a^4 - 5*a^2*b^2 + 2*b^4)*log(a*cos(c + d*x) + b*sin(c + d*x)))/((a^2 + b^2)^5*d) - (a^2*b)/(3*(a^2 + b^2)^2*d*(a + b*tan(c + d*x))^3) - (a*b*(a^2 - b^2))/((a^2 + b^2)^3*d*(a + b*tan(c + d*x))^2) - (b*(3*a^4 - 8*a^2*b^2 + b^4))/((a^2 + b^2)^4*d*(a + b*tan(c + d*x))) - (cos(c + d*x)^2*(4*a*b*(a^2 - b^2) + (a^4 - 6*a^2*b^2 + b^4)*tan(c + d*x)))/(2*(a^2 + b^2)^4*d)]
    @test_int [csc(c + d*x)^2/(a + b*tan(c + d*x))^4, x, 3, -(cot(c + d*x)/(a^4*d)) - (4*b*log(tan(c + d*x)))/(a^5*d) + (4*b*log(a + b*tan(c + d*x)))/(a^5*d) - b/(3*a^2*d*(a + b*tan(c + d*x))^3) - b/(a^3*d*(a + b*tan(c + d*x))^2) - (3*b)/(a^4*d*(a + b*tan(c + d*x)))]
    @test_int [csc(c + d*x)^4/(a + b*tan(c + d*x))^4, x, 3, -(((a^2 + 10*b^2)*cot(c + d*x))/(a^6*d)) + (2*b*cot(c + d*x)^2)/(a^5*d) - cot(c + d*x)^3/(3*a^4*d) - (4*b*(a^2 + 5*b^2)*log(tan(c + d*x)))/(a^7*d) + (4*b*(a^2 + 5*b^2)*log(a + b*tan(c + d*x)))/(a^7*d) - (b*(a^2 + b^2))/(3*a^4*d*(a + b*tan(c + d*x))^3) - (b*(a^2 + 2*b^2))/(a^5*d*(a + b*tan(c + d*x))^2) - (b*(3*a^2 + 10*b^2))/(a^6*d*(a + b*tan(c + d*x)))]
    @test_int [csc(c + d*x)^6/(a + b*tan(c + d*x))^4, x, 3, -(((a^4 + 20*a^2*b^2 + 35*b^4)*cot(c + d*x))/(a^8*d)) + (2*b*(2*a^2 + 5*b^2)*cot(c + d*x)^2)/(a^7*d) - (2*(a^2 + 5*b^2)*cot(c + d*x)^3)/(3*a^6*d) + (b*cot(c + d*x)^4)/(a^5*d) - cot(c + d*x)^5/(5*a^4*d) - (4*b*(a^4 + 10*a^2*b^2 + 14*b^4)*log(tan(c + d*x)))/(a^9*d) + (4*b*(a^4 + 10*a^2*b^2 + 14*b^4)*log(a + b*tan(c + d*x)))/(a^9*d) - (b*(a^2 + b^2)^2)/(3*a^6*d*(a + b*tan(c + d*x))^3) - (b*(a^2 + b^2)*(a^2 + 3*b^2))/(a^7*d*(a + b*tan(c + d*x))^2) - (b*(3*a^4 + 20*a^2*b^2 + 21*b^4))/(a^8*d*(a + b*tan(c + d*x)))]


    #= Hangs*Mathematica*6 & 7: =# 
    @test_int [csc(x)/(1 + tan(x)), x, 6, -atanh(cos(x)) + atanh((cos(x) - sin(x))/sqrt(2))/sqrt(2)]


    #= ::Subsection:: =#
    #=Integrands*of*the*form*sin(e+f*x)^m*(a+b*tan(e+f*x))^(n/2)=#


    #= ::Subsection:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^(m/2)*(a+b*tan(e+f*x))^n=#


    #= ::Subsection:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^(m/2)*(a+b*tan(e+f*x))^(n/2)=#


    #= ::Subsection::Closed:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^m*(a+b*tan(e+f*x))^n*with*m*symbolic=#


    @test_int [sin(c + d*x)^m*(a + b*tan(c + d*x))^3, x, 8, (a^3*cos(c + d*x)*HypergeometricFunctions._₂F₁(1/2, (1 + m)/2, (3 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(1 + m))/(d*(1 + m)*sqrt(cos(c + d*x)^2)) + (3*a^2*b*HypergeometricFunctions._₂F₁(1, (2 + m)/2, (4 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(2 + m))/(d*(2 + m)) + (3*a*b^2*sqrt(cos(c + d*x)^2)*HypergeometricFunctions._₂F₁(3/2, (3 + m)/2, (5 + m)/2, sin(c + d*x)^2)*sec(c + d*x)*sin(c + d*x)^(3 + m))/(d*(3 + m)) + (b^3*HypergeometricFunctions._₂F₁(2, (4 + m)/2, (6 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(4 + m))/(d*(4 + m))]
    @test_int [sin(c + d*x)^m*(a + b*tan(c + d*x))^2, x, 6, (a^2*cos(c + d*x)*HypergeometricFunctions._₂F₁(1/2, (1 + m)/2, (3 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(1 + m))/(d*(1 + m)*sqrt(cos(c + d*x)^2)) + (2*a*b*HypergeometricFunctions._₂F₁(1, (2 + m)/2, (4 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(2 + m))/(d*(2 + m)) + (b^2*sqrt(cos(c + d*x)^2)*HypergeometricFunctions._₂F₁(3/2, (3 + m)/2, (5 + m)/2, sin(c + d*x)^2)*sec(c + d*x)*sin(c + d*x)^(3 + m))/(d*(3 + m))]
    @test_int [sin(c + d*x)^m*(a + b*tan(c + d*x))^1, x, 5, (a*cos(c + d*x)*HypergeometricFunctions._₂F₁(1/2, (1 + m)/2, (3 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(1 + m))/(d*(1 + m)*sqrt(cos(c + d*x)^2)) + (b*HypergeometricFunctions._₂F₁(1, (2 + m)/2, (4 + m)/2, sin(c + d*x)^2)*sin(c + d*x)^(2 + m))/(d*(2 + m))]
    @test_int [sin(c + d*x)^m/(a + b*tan(c + d*x))^1, x, 14, (2^(1 + m)*HypergeometricFunctions._₂F₁((1 + m)/2, 1 + m, (3 + m)/2, -tan((1/2)*(c + d*x))^2)*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*d*(1 + m)) + (2^(1 + m)*b*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(sqrt(a^2 + b^2)*(b - sqrt(a^2 + b^2))*d*(2 + m)) - (2^(1 + m)*b*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(sqrt(a^2 + b^2)*(b + sqrt(a^2 + b^2))*d*(2 + m)) + (2^(1 + m)*a*b*AppellF1((3 + m)/2, 1 + m, 1, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(sqrt(a^2 + b^2)*(b - sqrt(a^2 + b^2))^2*d*(3 + m)) - (2^(1 + m)*a*b*AppellF1((3 + m)/2, 1 + m, 1, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(sqrt(a^2 + b^2)*(b + sqrt(a^2 + b^2))^2*d*(3 + m))]
    #= [sin(c + d*x)^m/(a + b*tan(c + d*x))^2, x, 52, -((2^(1 + m)*b^2*AppellF1((1 + m)/2, 1 + m, 1, (3 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)^(3/2)*(b - sqrt(a^2 + b^2))*d*(1 + m))) - (2^(2 + m)*b*(1 - (2*b)/sqrt(a^2 + b^2))*AppellF1((1 + m)/2, 1 + m, 1, (3 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a^2*(b - sqrt(a^2 + b^2))*d*(1 + m)) + (2^(1 + m)*b^2*AppellF1((1 + m)/2, 1 + m, 1, (3 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)^(3/2)*(b + sqrt(a^2 + b^2))*d*(1 + m)) - (2^(2 + m)*b*(1 + (2*b)/sqrt(a^2 + b^2))*AppellF1((1 + m)/2, 1 + m, 1, (3 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a^2*(b + sqrt(a^2 + b^2))*d*(1 + m)) + (2^(1 + m)*b^2*(b - sqrt(a^2 + b^2))^2*AppellF1((1 + m)/2, 1 + m, 2, (3 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b - sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b - sqrt(a^2 + b^2)))^2*d*(1 + m)) + (2^(1 + m)*b^2*(b + sqrt(a^2 + b^2))^2*AppellF1((1 + m)/2, 1 + m, 2, (3 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b + sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b + sqrt(a^2 + b^2)))^2*d*(1 + m)) + (2^(1 + m)*HypergeometricFunctions._₂F₁((1 + m)/2, 1 + m, (3 + m)/2, -tan((1/2)*(c + d*x))^2)*tan((1/2)*(c + d*x))*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a^2*d*(1 + m)) - (2^(1 + m)*a*b^2*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)^(3/2)*(b - sqrt(a^2 + b^2))^2*d*(2 + m)) - (2^(2 + m)*b*(1 - (2*b)/sqrt(a^2 + b^2))*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*(b - sqrt(a^2 + b^2))^2*d*(2 + m)) - (2^(2 + m)*b^3*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*(a^2 + b^2)^(3/2)*(b - sqrt(a^2 + b^2))*d*(2 + m)) + (2^(1 + m)*a*b^2*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)^(3/2)*(b + sqrt(a^2 + b^2))^2*d*(2 + m)) - (2^(2 + m)*b*(1 + (2*b)/sqrt(a^2 + b^2))*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*(b + sqrt(a^2 + b^2))^2*d*(2 + m)) + (2^(2 + m)*b^3*AppellF1((2 + m)/2, 1 + m, 1, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*(a^2 + b^2)^(3/2)*(b + sqrt(a^2 + b^2))*d*(2 + m)) + (2^(2 + m)*a*b^2*(b - sqrt(a^2 + b^2))*AppellF1((2 + m)/2, 1 + m, 2, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b - sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b - sqrt(a^2 + b^2)))^2*d*(2 + m)) + (2^(2 + m)*b^3*(b - sqrt(a^2 + b^2))^2*AppellF1((2 + m)/2, 1 + m, 2, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b - sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*(a^2 + b^2)*(a^2 + 2*b*(b - sqrt(a^2 + b^2)))^2*d*(2 + m)) + (2^(2 + m)*a*b^2*(b + sqrt(a^2 + b^2))*AppellF1((2 + m)/2, 1 + m, 2, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b + sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b + sqrt(a^2 + b^2)))^2*d*(2 + m)) + (2^(2 + m)*b^3*(b + sqrt(a^2 + b^2))^2*AppellF1((2 + m)/2, 1 + m, 2, (4 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b + sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^2*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/(a*(a^2 + b^2)*(a^2 + 2*b*(b + sqrt(a^2 + b^2)))^2*d*(2 + m)) - (2^(2 + m)*b^3*AppellF1((3 + m)/2, 1 + m, 1, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b - sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)^(3/2)*(b - sqrt(a^2 + b^2))^2*d*(3 + m)) + (2^(2 + m)*b^3*AppellF1((3 + m)/2, 1 + m, 1, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(b + sqrt(a^2 + b^2))^2)*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)^(3/2)*(b + sqrt(a^2 + b^2))^2*d*(3 + m)) + (2^(1 + m)*a^2*b^2*AppellF1((3 + m)/2, 1 + m, 2, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b - sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b - sqrt(a^2 + b^2)))^2*d*(3 + m)) + (2^(3 + m)*b^3*(b - sqrt(a^2 + b^2))*AppellF1((3 + m)/2, 1 + m, 2, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b - sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b - sqrt(a^2 + b^2)))^2*d*(3 + m)) + (2^(1 + m)*a^2*b^2*AppellF1((3 + m)/2, 1 + m, 2, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b + sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b + sqrt(a^2 + b^2)))^2*d*(3 + m)) + (2^(3 + m)*b^3*(b + sqrt(a^2 + b^2))*AppellF1((3 + m)/2, 1 + m, 2, (5 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b + sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^3*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b + sqrt(a^2 + b^2)))^2*d*(3 + m)) + (2^(2 + m)*a*b^3*AppellF1((4 + m)/2, 1 + m, 2, (6 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b - sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^4*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b - sqrt(a^2 + b^2)))^2*d*(4 + m)) + (2^(2 + m)*a*b^3*AppellF1((4 + m)/2, 1 + m, 2, (6 + m)/2, -tan((1/2)*(c + d*x))^2, (a^2*tan((1/2)*(c + d*x))^2)/(a^2 + 2*b*(b + sqrt(a^2 + b^2))))*tan((1/2)*(c + d*x))^4*(tan((1/2)*(c + d*x))/(1 + tan((1/2)*(c + d*x))^2))^m*(1 + tan((1/2)*(c + d*x))^2)^m)/((a^2 + b^2)*(a^2 + 2*b*(b + sqrt(a^2 + b^2)))^2*d*(4 + m))] =#


    #= ::Subsection::Closed:: =#
    #=Integrands*of*the*form*(d*sin(e+f*x))^m*(a+b*tan(e+f*x))^n*with*n*symbolic=#


    @test_int [sin(c + d*x)^m*(a + b*tan(c + d*x))^n, x, 0, CannotIntegrate(sin(c + d*x)^m*(a + b*tan(c + d*x))^n, x)]


    @test_int [sin(c + d*x)^4*(a + b*tan(c + d*x))^n, x, 7, -(((a*b^2*n*(5*a^2 + b^2*(3 + 2*n)) + sqrt(-b^2)*(3*a^4 + a^2*b^2*(6 + 6*n - n^2) + b^4*(3 + 4*n + n^2)))*HypergeometricFunctions._₂F₁(1, 1 + n, 2 + n, (a + b*tan(c + d*x))/(a - sqrt(-b^2)))*(a + b*tan(c + d*x))^(1 + n))/(16*b*(a^2 + b^2)^2*(a - sqrt(-b^2))*d*(1 + n))) - ((a*b^2*n*(5*a^2 + b^2*(3 + 2*n)) - sqrt(-b^2)*(3*a^4 + a^2*b^2*(6 + 6*n - n^2) + b^4*(3 + 4*n + n^2)))*HypergeometricFunctions._₂F₁(1, 1 + n, 2 + n, (a + b*tan(c + d*x))/(a + sqrt(-b^2)))*(a + b*tan(c + d*x))^(1 + n))/(16*b*(a^2 + b^2)^2*(a + sqrt(-b^2))*d*(1 + n)) + (cos(c + d*x)^4*(b + a*tan(c + d*x))*(a + b*tan(c + d*x))^(1 + n))/(4*(a^2 + b^2)*d) - (cos(c + d*x)^2*(a + b*tan(c + d*x))^(1 + n)*(b*(a^2*(7 - n) + b^2*(5 + n)) + a*(5*a^2 + b^2*(3 + 2*n))*tan(c + d*x)))/(8*(a^2 + b^2)^2*d)]
    @test_int [sin(c + d*x)^2*(a + b*tan(c + d*x))^n, x, 6, -(((a*b^2*n + sqrt(-b^2)*(a^2 + b^2*(1 + n)))*HypergeometricFunctions._₂F₁(1, 1 + n, 2 + n, (a + b*tan(c + d*x))/(a - sqrt(-b^2)))*(a + b*tan(c + d*x))^(1 + n))/(4*b*(a^2 + b^2)*(a - sqrt(-b^2))*d*(1 + n))) - ((a*b^2*n - sqrt(-b^2)*(a^2 + b^2*(1 + n)))*HypergeometricFunctions._₂F₁(1, 1 + n, 2 + n, (a + b*tan(c + d*x))/(a + sqrt(-b^2)))*(a + b*tan(c + d*x))^(1 + n))/(4*b*(a^2 + b^2)*(a + sqrt(-b^2))*d*(1 + n)) - (cos(c + d*x)^2*(b + a*tan(c + d*x))*(a + b*tan(c + d*x))^(1 + n))/(2*(a^2 + b^2)*d)]
    @test_int [csc(c + d*x)^2*(a + b*tan(c + d*x))^n, x, 2, (b*HypergeometricFunctions._₂F₁(2, 1 + n, 2 + n, 1 + (b*tan(c + d*x))/a)*(a + b*tan(c + d*x))^(1 + n))/(a^2*d*(1 + n))]
    @test_int [csc(c + d*x)^4*(a + b*tan(c + d*x))^n, x, 4, (b*(2 - n)*cot(c + d*x)^2*(a + b*tan(c + d*x))^(1 + n))/(6*a^2*d) - (cot(c + d*x)^3*(a + b*tan(c + d*x))^(1 + n))/(3*a*d) + (b*(6*a^2 + b^2*(2 - 3*n + n^2))*HypergeometricFunctions._₂F₁(2, 1 + n, 2 + n, 1 + (b*tan(c + d*x))/a)*(a + b*tan(c + d*x))^(1 + n))/(6*a^4*d*(1 + n))]

    @test_int [sin(c + d*x)^3*(a + b*tan(c + d*x))^n, x, 0, CannotIntegrate(sin(c + d*x)^3*(a + b*tan(c + d*x))^n, x)]
    @test_int [sin(c + d*x)^1*(a + b*tan(c + d*x))^n, x, 0, CannotIntegrate(sin(c + d*x)*(a + b*tan(c + d*x))^n, x)]
    @test_int [csc(c + d*x)^1*(a + b*tan(c + d*x))^n, x, 0, CannotIntegrate(csc(c + d*x)*(a + b*tan(c + d*x))^n, x)]
    @test_int [csc(c + d*x)^3*(a + b*tan(c + d*x))^n, x, 0, CannotIntegrate(csc(c + d*x)^3*(a + b*tan(c + d*x))^n, x)]


    #= ::Section::Closed:: =#
    #=Integrands*of*the*form*(d*csc(e+f*x))^m*(a+b*tan(e+f*x))^n=#


    #= ::Subsection:: =#
    #=Integrands*of*the*form*csc(e+f*x)^(m/2)*(a+b*tan(e+f*x))^n=#


    #= ::Subsection:: =#
    #=Integrands*of*the*form*csc(e+f*x)^(m/2)*(a+b*tan(e+f*x))^(n/2)=#
    end
